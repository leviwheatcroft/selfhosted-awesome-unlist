<!DOCTYPE html><html><head><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="A lightweight and simple comment engine, which doesn't spy on users. It can be embedded into blogs, articles or any other place where readers add comments."><meta name="DCTERMS.issued"><meta name="DCTERMS.modified"><title></title><link href="https://fonts.googleapis.com/css2?family=Special+Elite&amp;display=swap" rel="stylesheet"><link href="/selfhosted-awesome-unlist/site.css" rel="stylesheet" type="text/css"></head></head><body class="project"><nav class="navigation"><section class="container"><a class="navigation-title" href="/selfhosted-awesome-unlist/">Selfhosted Awesome [Un]list</a></section></nav><header><div class="container"><div class="row"><div class="column"><div class="title"><h1>remark42</h1><span class="subheading">A lightweight and simple comment engine, which doesn't spy on users. It can be embedded into blogs, articles or any other place where readers add comments.</span><div class="links"><a class="button button-outline" href="https://remark42.com/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>remark42</a><a class="button button-outline" href="https://remark42.com/demo/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-box"><path d="M21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16z"></path><polyline points="3.27 6.96 12 12.01 20.73 6.96"></polyline><line x1="12" y1="22.08" x2="12" y2="12"></line></svg>Demo</a><a class="button button-outline" href="https://github.com/umputun/remark"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>Source Code</a></div></div></div></div></div></header><section><div class="container"><div class="row"><div class="column"><div class="info statistics"><span class="stat pushed-at"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg>24 May 2020</span><span class="stat stargazers-count"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>1532</span><span class="stat issues"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>53</span></div></div></div><div class="row"><div class="column"><div class="info tags"><a class="tag" href="/selfhosted-awesome-unlist/tags/go.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">91</span>go</a><span class="tag"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bookmark"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg><span class="count">1</span>comment-system</span><a class="tag" href="/selfhosted-awesome-unlist/tags/commenting.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">2</span>commenting</a><span class="tag"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bookmark"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg><span class="count">1</span>commenting-engines</span><a class="tag" href="/selfhosted-awesome-unlist/tags/comments-widget.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">2</span>comments-widget</a><a class="tag" href="/selfhosted-awesome-unlist/tags/privacy.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">15</span>privacy</a><span class="tag"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-bookmark"><path d="M19 21l-7-5-7 5V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2z"></path></svg><span class="count">1</span>remark42</span><a class="tag" href="/selfhosted-awesome-unlist/tags/self-hosted.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">77</span>self-hosted</a><a class="tag" href="/selfhosted-awesome-unlist/tags/communication-systems.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">159</span>communication systems</a><a class="tag" href="/selfhosted-awesome-unlist/tags/selfhosted.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">943</span>selfhosted</a><a class="tag" href="/selfhosted-awesome-unlist/tags/docker.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">329</span>docker</a></div></div></div></div></section><article><div class="container"><div class="row"><div class="column">
<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><h1><a id="user-content-remark42---" class="anchor" aria-hidden="true" href="#remark42---"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>remark42 <a href="https://github.com/umputun/remark42/actions"><img src="https://github.com/umputun/remark42/workflows/build/badge.svg" alt="Build Status" style="max-width:100%;"></a> <a href="https://goreportcard.com/report/github.com/umputun/remark42" rel="nofollow"><img src="https://camo.githubusercontent.com/2bb5d09f81fd8da9c2e2c60aade4812aa2c3b4ab/68747470733a2f2f676f7265706f7274636172642e636f6d2f62616467652f6769746875622e636f6d2f756d707574756e2f72656d61726b3432" alt="Go Report Card" data-canonical-src="https://goreportcard.com/badge/github.com/umputun/remark42" style="max-width:100%;"></a> <a href="https://coveralls.io/github/umputun/remark42?branch=master" rel="nofollow"><img src="https://camo.githubusercontent.com/2a4370695bd2d0babd592f6871d7e5b8baf98655/68747470733a2f2f636f766572616c6c732e696f2f7265706f732f6769746875622f756d707574756e2f72656d61726b34322f62616467652e7376673f6272616e63683d6d6173746572" alt="Coverage Status" data-canonical-src="https://coveralls.io/repos/github/umputun/remark42/badge.svg?branch=master" style="max-width:100%;"></a></h1>
<p>Remark42 is a self-hosted, lightweight, and simple (yet functional) comment engine, which doesn't spy on users. It can be embedded into blogs, articles or any other place where readers add comments.</p>
<ul>
<li>Social login via Google, Twitter, Facebook, GitHub and Yandex</li>
<li>Login via email</li>
<li>Optional anonymous access</li>
<li>Multi-level nested comments with both tree and plain presentations</li>
<li>Import from Disqus and WordPress</li>
<li>Markdown support with friendly formatter toolbar</li>
<li>Moderator can remove comments and block users</li>
<li>Voting, pinning and verification system</li>
<li>Sortable comments</li>
<li>Images upload with drag-and-drop</li>
<li>Extractor for recent comments, cross-post</li>
<li>RSS for all comments and each post</li>
<li>Telegram and email notifications</li>
<li>Export data to json with automatic backups</li>
<li>No external databases, everything embedded in a single data file</li>
<li>Fully dockerized and can be deployed in a single command</li>
<li>Self-contained executable can be deployed directly to Linux, Windows and MacOS</li>
<li>Clean, lightweight and customizable UI with white and dark themes</li>
<li>Multi-site mode from a single instance</li>
<li>Integration with automatic ssl (direct and via <a href="https://github.com/umputun/nginx-le">nginx-le</a>)</li>
<li><a href="#privacy">Privacy focused</a></li>
</ul>
<p><a href="https://remark42.com/demo/" rel="nofollow">Demo site</a> available with all authentication methods, including email auth and anonymous access.</p>
<details><summary>Screenshots</summary>
<p>Comments example:
<a target="_blank" rel="noopener noreferrer" href="https://github.com/umputun/remark42/blob/master/screenshots/comments.png"><img src="https://github.com/umputun/remark42/raw/master/screenshots/comments.png" alt="" style="max-width:100%;"></a></p>
<p>For admin screenshots see <a href="https://github.com/umputun/remark42/wiki/Admin-UI">Admin UI wiki</a></p>
</details>
<h1></h1>
<ul>
<li><a href="#install">Install</a>
<ul>
<li><a href="#backend">Backend</a>
<ul>
<li><a href="#with-docker">With Docker</a></li>
<li><a href="#without-docker">Without Docker</a></li>
<li><a href="#parameters">Parameters</a>
<ul>
<li><a href="#required-parameters">Required parameters</a></li>
</ul>
</li>
<li><a href="#quick-installation-test">Quick installation test</a></li>
<li><a href="#register-oauth2-providers">Register oauth2 providers</a>
<ul>
<li><a href="#google-auth-provider">Google Auth Provider</a></li>
<li><a href="#github-auth-provider">GitHub Auth Provider</a></li>
<li><a href="#facebook-auth-provider">Facebook Auth Provider</a></li>
<li><a href="#twitter-auth-provider">Twitter Auth Provider</a></li>
<li><a href="#yandex-auth-provider">Yandex Auth Provider</a></li>
</ul>
</li>
<li><a href="#initial-import-from-disqus">Initial import from Disqus</a></li>
<li><a href="#initial-import-from-wordpress">Initial import from WordPress</a></li>
<li><a href="#backup-and-restore">Backup and restore</a>
<ul>
<li><a href="#automatic-backups">Automatic backups</a></li>
<li><a href="#manual-backup">Manual backup</a></li>
<li><a href="#restore-from-backup">Restore from backup</a></li>
<li><a href="#backup-format">Backup format</a></li>
</ul>
</li>
<li><a href="#admin-users">Admin users</a></li>
</ul>
</li>
<li><a href="#setup-on-your-website">Setup on your website</a>
<ul>
<li><a href="#comments">Comments</a></li>
<li><a href="#last-comments">Last comments</a></li>
<li><a href="#counter">Counter</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#build-from-the-source">Build from the source</a></li>
<li><a href="#development">Development</a>
<ul>
<li><a href="#backend-development">Backend development</a></li>
<li><a href="#frontend-development">Frontend development</a>
<ul>
<li><a href="#build">Build</a></li>
<li><a href="#devserver">Devserver</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#api">API</a>
<ul>
<li><a href="#authorization">Authorization</a></li>
<li><a href="#commenting">Commenting</a></li>
<li><a href="#rss-feeds">RSS feeds</a></li>
<li><a href="#admin">Admin</a></li>
</ul>
</li>
<li><a href="#privacy">Privacy</a></li>
<li><a href="#technical-details">Technical details</a></li>
</ul>
<h2><a id="user-content-install" class="anchor" aria-hidden="true" href="#install"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Install</h2>
<h3><a id="user-content-backend" class="anchor" aria-hidden="true" href="#backend"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Backend</h3>
<h4><a id="user-content-with-docker" class="anchor" aria-hidden="true" href="#with-docker"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>With Docker</h4>
<p><em>this is the recommended way to run remark42</em></p>
<ul>
<li>copy provided <code>docker-compose.yml</code> and customize for your needs</li>
<li>make sure you <strong>don't keep</strong> <code>ADMIN_PASSWD=something...</code> for any non-development deployments</li>
<li>pull prepared images from the DockerHub and start - <code>docker-compose pull &amp;&amp; docker-compose up -d</code></li>
<li>alternatively compile from the sources - <code>docker-compose build &amp;&amp; docker-compose up -d</code></li>
</ul>
<h4><a id="user-content-without-docker" class="anchor" aria-hidden="true" href="#without-docker"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Without Docker</h4>
<ul>
<li>download archive for <a href="https://github.com/umputun/remark42/releases">stable release</a> or <a href="https://remark42.com/downloads" rel="nofollow">development version</a></li>
<li>unpack with <code>gunzip</code> (Linux, macOS) or with <code>zip</code> (Windows)</li>
<li>run as <code>remark42.{os}-{arch} server {parameters...}</code>, i.e. <code>remark42.linux-amd64 server --secret=12345 --url=http://127.0.0.1:8080</code></li>
<li>alternatively compile from the sources - <code>make OS=[linux|darwin|windows] ARCH=[amd64,386,arm64,arm]</code></li>
</ul>
<h4><a id="user-content-parameters" class="anchor" aria-hidden="true" href="#parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Parameters</h4>
<table>
<thead>
<tr>
<th>Command line</th>
<th>Environment</th>
<th>Default</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>url</td>
<td>REMARK_URL</td>
<td></td>
<td>url to remark42 server, <em>required</em></td>
</tr>
<tr>
<td>secret</td>
<td>SECRET</td>
<td></td>
<td>secret key, <em>required</em></td>
</tr>
<tr>
<td>site</td>
<td>SITE</td>
<td><code>remark</code></td>
<td>site name(s), <em>multi</em></td>
</tr>
<tr>
<td>store.type</td>
<td>STORE_TYPE</td>
<td><code>bolt</code></td>
<td>type of storage, <code>bolt</code> or <code>rpc</code></td>
</tr>
<tr>
<td>store.bolt.path</td>
<td>STORE_BOLT_PATH</td>
<td><code>./var</code></td>
<td>path to data directory</td>
</tr>
<tr>
<td>store.bolt.timeout</td>
<td>STORE_BOLT_TIMEOUT</td>
<td><code>30s</code></td>
<td>boltdb access timeout</td>
</tr>
<tr>
<td>admin.shared.id</td>
<td>ADMIN_SHARED_ID</td>
<td></td>
<td>admin names (list of user ids), <em>multi</em></td>
</tr>
<tr>
<td>admin.shared.email</td>
<td>ADMIN_SHARED_EMAIL</td>
<td><code>admin@${REMARK_URL}</code></td>
<td>admin email</td>
</tr>
<tr>
<td>backup</td>
<td>BACKUP_PATH</td>
<td><code>./var/backup</code></td>
<td>backups location</td>
</tr>
<tr>
<td>max-back</td>
<td>MAX_BACKUP_FILES</td>
<td><code>10</code></td>
<td>max backup files to keep</td>
</tr>
<tr>
<td>cache.max.items</td>
<td>CACHE_MAX_ITEMS</td>
<td><code>1000</code></td>
<td>max number of cached items, <code>0</code> - unlimited</td>
</tr>
<tr>
<td>cache.max.value</td>
<td>CACHE_MAX_VALUE</td>
<td><code>65536</code></td>
<td>max size of cached value, <code>0</code> - unlimited</td>
</tr>
<tr>
<td>cache.max.size</td>
<td>CACHE_MAX_SIZE</td>
<td><code>50000000</code></td>
<td>max size of all cached values, <code>0</code> - unlimited</td>
</tr>
<tr>
<td>avatar.type</td>
<td>AVATAR_TYPE</td>
<td><code>fs</code></td>
<td>type of avatar storage, <code>fs</code>, <code>bolt</code>, or <code>uri</code></td>
</tr>
<tr>
<td>avatar.fs.path</td>
<td>AVATAR_FS_PATH</td>
<td><code>./var/avatars</code></td>
<td>avatars location for <code>fs</code> store</td>
</tr>
<tr>
<td>avatar.bolt.file</td>
<td>AVATAR_BOLT_FILE</td>
<td><code>./var/avatars.db</code></td>
<td>file name for  <code>bolt</code> store</td>
</tr>
<tr>
<td>avatar.uri</td>
<td>AVATAR_URI</td>
<td><code>./var/avatars</code></td>
<td>avatar store uri</td>
</tr>
<tr>
<td>avatar.rsz-lmt</td>
<td>AVATAR_RSZ_LMT</td>
<td><code>0</code> (disabled)</td>
<td>max image size for resizing avatars on save</td>
</tr>
<tr>
<td>image.type</td>
<td>IMAGE_TYPE</td>
<td><code>fs</code></td>
<td>type of image storage, <code>fs</code>, <code>bolt</code></td>
</tr>
<tr>
<td>image.max-size</td>
<td>IMAGE_MAX_SIZE</td>
<td><code>5000000</code></td>
<td>max size of image file</td>
</tr>
<tr>
<td>image.fs.path</td>
<td>IMAGE_FS_PATH</td>
<td><code>./var/pictures</code></td>
<td>permanent location of images</td>
</tr>
<tr>
<td>image.fs.staging</td>
<td>IMAGE_FS_STAGING</td>
<td><code>./var/pictures.staging</code></td>
<td>staging location of images</td>
</tr>
<tr>
<td>image.fs.partitions</td>
<td>IMAGE_FS_PARTITIONS</td>
<td><code>100</code></td>
<td>number of image partitions</td>
</tr>
<tr>
<td>image.bolt.file</td>
<td>IMAGE_BOLT_FILE</td>
<td><code>/var/pictures.db</code></td>
<td>images bolt file location</td>
</tr>
<tr>
<td>image.resize-width</td>
<td>IMAGE_RESIZE_WIDTH</td>
<td><code>2400</code></td>
<td>width of resized image</td>
</tr>
<tr>
<td>image.resize-height</td>
<td>IMAGE_RESIZE_HEIGHT</td>
<td><code>900</code></td>
<td>height of resized image</td>
</tr>
<tr>
<td>auth.ttl.jwt</td>
<td>AUTH_TTL_JWT</td>
<td><code>5m</code></td>
<td>jwt TTL</td>
</tr>
<tr>
<td>auth.ttl.cookie</td>
<td>AUTH_TTL_COOKIE</td>
<td><code>200h</code></td>
<td>cookie TTL</td>
</tr>
<tr>
<td>auth.google.cid</td>
<td>AUTH_GOOGLE_CID</td>
<td></td>
<td>Google OAuth client ID</td>
</tr>
<tr>
<td>auth.google.csec</td>
<td>AUTH_GOOGLE_CSEC</td>
<td></td>
<td>Google OAuth client secret</td>
</tr>
<tr>
<td>auth.facebook.cid</td>
<td>AUTH_FACEBOOK_CID</td>
<td></td>
<td>Facebook OAuth client ID</td>
</tr>
<tr>
<td>auth.facebook.csec</td>
<td>AUTH_FACEBOOK_CSEC</td>
<td></td>
<td>Facebook OAuth client secret</td>
</tr>
<tr>
<td>auth.github.cid</td>
<td>AUTH_GITHUB_CID</td>
<td></td>
<td>Github OAuth client ID</td>
</tr>
<tr>
<td>auth.github.csec</td>
<td>AUTH_GITHUB_CSEC</td>
<td></td>
<td>Github OAuth client secret</td>
</tr>
<tr>
<td>auth.twitter.cid</td>
<td>AUTH_TWITTER_CID</td>
<td></td>
<td>Twitter Consumer API Key</td>
</tr>
<tr>
<td>auth.twitter.csec</td>
<td>AUTH_TWITTER_CSEC</td>
<td></td>
<td>Twitter Consumer API Secret key</td>
</tr>
<tr>
<td>auth.yandex.cid</td>
<td>AUTH_YANDEX_CID</td>
<td></td>
<td>Yandex OAuth client ID</td>
</tr>
<tr>
<td>auth.yandex.csec</td>
<td>AUTH_YANDEX_CSEC</td>
<td></td>
<td>Yandex OAuth client secret</td>
</tr>
<tr>
<td>auth.dev</td>
<td>AUTH_DEV</td>
<td><code>false</code></td>
<td>local oauth2 server, development mode only</td>
</tr>
<tr>
<td>auth.anon</td>
<td>AUTH_ANON</td>
<td><code>false</code></td>
<td>enable anonymous login</td>
</tr>
<tr>
<td>auth.email.enable</td>
<td>AUTH_EMAIL_ENABLE</td>
<td><code>false</code></td>
<td>enable auth via email</td>
</tr>
<tr>
<td>auth.email.from</td>
<td>AUTH_EMAIL_FROM</td>
<td></td>
<td>email from</td>
</tr>
<tr>
<td>auth.email.subj</td>
<td>AUTH_EMAIL_SUBJ</td>
<td><code>remark42 confirmation</code></td>
<td>email subject</td>
</tr>
<tr>
<td>auth.email.content-type</td>
<td>AUTH_EMAIL_CONTENT_TYPE</td>
<td><code>text/html</code></td>
<td>email content type</td>
</tr>
<tr>
<td>auth.email.template</td>
<td>AUTH_EMAIL_TEMPLATE</td>
<td>none (predefined)</td>
<td>custom email message template file</td>
</tr>
<tr>
<td>notify.type</td>
<td>NOTIFY_TYPE</td>
<td>none</td>
<td>type of notification (telegram and/or email)</td>
</tr>
<tr>
<td>notify.queue</td>
<td>NOTIFY_QUEUE</td>
<td><code>100</code></td>
<td>size of notification queue</td>
</tr>
<tr>
<td>notify.telegram.token</td>
<td>NOTIFY_TELEGRAM_TOKEN</td>
<td></td>
<td>telegram token</td>
</tr>
<tr>
<td>notify.telegram.chan</td>
<td>NOTIFY_TELEGRAM_CHAN</td>
<td></td>
<td>telegram channel</td>
</tr>
<tr>
<td>notify.telegram.timeout</td>
<td>NOTIFY_TELEGRAM_TIMEOUT</td>
<td><code>5s</code></td>
<td>telegram timeout</td>
</tr>
<tr>
<td>notify.email.fromAddress</td>
<td>NOTIFY_EMAIL_FROM</td>
<td></td>
<td>from email address</td>
</tr>
<tr>
<td>notify.email.verification_subj</td>
<td>NOTIFY_EMAIL_VERIFICATION_SUBJ</td>
<td><code>Email verification</code></td>
<td>verification message subject</td>
</tr>
<tr>
<td>notify.email.notify_admin</td>
<td>NOTIFY_EMAIL_ADMIN</td>
<td><code>false</code></td>
<td>notify admin on new comments via ADMIN_SHARED_EMAIL</td>
</tr>
<tr>
<td>smtp.host</td>
<td>SMTP_HOST</td>
<td></td>
<td>SMTP host</td>
</tr>
<tr>
<td>smtp.port</td>
<td>SMTP_PORT</td>
<td></td>
<td>SMTP port</td>
</tr>
<tr>
<td>smtp.username</td>
<td>SMTP_USERNAME</td>
<td></td>
<td>SMTP user name</td>
</tr>
<tr>
<td>smtp.password</td>
<td>SMTP_PASSWORD</td>
<td></td>
<td>SMTP password</td>
</tr>
<tr>
<td>smtp.tls</td>
<td>SMTP_TLS</td>
<td></td>
<td>enable TLS for SMTP</td>
</tr>
<tr>
<td>smtp.timeout</td>
<td>SMTP_TIMEOUT</td>
<td><code>10s</code></td>
<td>SMTP TCP connection timeout</td>
</tr>
<tr>
<td>ssl.type</td>
<td>SSL_TYPE</td>
<td>none</td>
<td><code>none</code>-http, <code>static</code>-https, <code>auto</code>-https + le</td>
</tr>
<tr>
<td>ssl.port</td>
<td>SSL_PORT</td>
<td><code>8443</code></td>
<td>port for https server</td>
</tr>
<tr>
<td>ssl.cert</td>
<td>SSL_CERT</td>
<td></td>
<td>path to cert.pem file</td>
</tr>
<tr>
<td>ssl.key</td>
<td>SSL_KEY</td>
<td></td>
<td>path to key.pem file</td>
</tr>
<tr>
<td>ssl.acme-location</td>
<td>SSL_ACME_LOCATION</td>
<td><code>./var/acme</code></td>
<td>dir where obtained le-certs will be stored</td>
</tr>
<tr>
<td>ssl.acme-email</td>
<td>SSL_ACME_EMAIL</td>
<td></td>
<td>admin email for receiving notifications from LE</td>
</tr>
<tr>
<td>max-comment</td>
<td>MAX_COMMENT_SIZE</td>
<td><code>2048</code></td>
<td>comment's size limit</td>
</tr>
<tr>
<td>max-votes</td>
<td>MAX_VOTES</td>
<td><code>-1</code></td>
<td>votes limit per comment, <code>-1</code> - unlimited</td>
</tr>
<tr>
<td>votes-ip</td>
<td>VOTES_IP</td>
<td><code>false</code></td>
<td>restrict votes from the same ip</td>
</tr>
<tr>
<td>anon-vote</td>
<td>ANON_VOTE</td>
<td><code>false</code></td>
<td>allow voting for anonymous users, require VOTES_IP to be enabled as well</td>
</tr>
<tr>
<td>votes-ip-time</td>
<td>VOTES_IP_TIME</td>
<td><code>5m</code></td>
<td>same ip vote restriction time, <code>0s</code> - unlimited</td>
</tr>
<tr>
<td>low-score</td>
<td>LOW_SCORE</td>
<td><code>-5</code></td>
<td>low score threshold</td>
</tr>
<tr>
<td>critical-score</td>
<td>CRITICAL_SCORE</td>
<td><code>-10</code></td>
<td>critical score threshold</td>
</tr>
<tr>
<td>positive-score</td>
<td>POSITIVE_SCORE</td>
<td><code>false</code></td>
<td>restricts comment's score to be only positive</td>
</tr>
<tr>
<td>restricted-words</td>
<td>RESTRICTED_WORDS</td>
<td></td>
<td>words banned in comments (can use <code>*</code>), <em>multi</em></td>
</tr>
<tr>
<td>edit-time</td>
<td>EDIT_TIME</td>
<td><code>5m</code></td>
<td>edit window</td>
</tr>
<tr>
<td>read-age</td>
<td>READONLY_AGE</td>
<td></td>
<td>read-only age of comments, days</td>
</tr>
<tr>
<td>image-proxy.http2https</td>
<td>IMAGE_PROXY_HTTP2HTTPS</td>
<td><code>false</code></td>
<td>enable http-&gt;https proxy for images</td>
</tr>
<tr>
<td>image-proxy.cache-external</td>
<td>IMAGE_PROXY_CACHE_EXTERNAL</td>
<td><code>false</code></td>
<td>enable caching external images to current image storage</td>
</tr>
<tr>
<td>emoji</td>
<td>EMOJI</td>
<td><code>false</code></td>
<td>enable emoji support</td>
</tr>
<tr>
<td>simple-view</td>
<td>SIMPLE_VIEW</td>
<td><code>false</code></td>
<td>minimized UI with basic info only</td>
</tr>
<tr>
<td>port</td>
<td>REMARK_PORT</td>
<td><code>8080</code></td>
<td>web server port</td>
</tr>
<tr>
<td>web-root</td>
<td>REMARK_WEB_ROOT</td>
<td><code>./web</code></td>
<td>web server root directory</td>
</tr>
<tr>
<td>update-limit</td>
<td>UPDATE_LIMIT</td>
<td><code>0.5</code></td>
<td>updates/sec limit</td>
</tr>
<tr>
<td>admin-passwd</td>
<td>ADMIN_PASSWD</td>
<td>none (disabled)</td>
<td>password for <code>admin</code> basic auth</td>
</tr>
<tr>
<td>dbg</td>
<td>DEBUG</td>
<td><code>false</code></td>
<td>debug mode</td>
</tr>
</tbody>
</table>
<ul>
<li>command line parameters are long form <code>--&lt;key&gt;=value</code>, i.e. <code>--site=https://demo.remark42.com</code></li>
<li><em>multi</em> parameters separated by <code>,</code> in the environment or repeated with command line key, like <code>--site=s1 --site=s2 ...</code></li>
<li><em>required</em> parameters have to be presented in the environment or provided in command line</li>
</ul>
<h5><a id="user-content-deprecated" class="anchor" aria-hidden="true" href="#deprecated"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deprecated</h5>
<p>Following list of command-line options is deprecated and will be removed in 2 minor releases or 1 major release (whichever is closer)
from the version in which they were deprecated. After remark42 version update, please check startup log once for deprecation warnings to avoid
trouble with unrecognized command-line options in the future.</p>
<details>
<summary>deprecated options</summary>
<table>
<thead>
<tr>
<th>Command line</th>
<th>Replacement</th>
<th>Environment</th>
<th>Replacement</th>
<th>Default</th>
<th>Description</th>
<th>Deprecation version</th>
</tr>
</thead>
<tbody>
<tr>
<td>auth.email.host</td>
<td>smtp.host</td>
<td>AUTH_EMAIL_HOST</td>
<td>SMTP_HOST</td>
<td></td>
<td>smtp host</td>
<td>1.5.0</td>
</tr>
<tr>
<td>auth.email.port</td>
<td>smtp.port</td>
<td>AUTH_EMAIL_PORT</td>
<td>SMTP_PORT</td>
<td></td>
<td>smtp port</td>
<td>1.5.0</td>
</tr>
<tr>
<td>auth.email.user</td>
<td>smtp.username</td>
<td>AUTH_EMAIL_USER</td>
<td>SMTP_USERNAME</td>
<td></td>
<td>smtp user name</td>
<td>1.5.0</td>
</tr>
<tr>
<td>auth.email.passwd</td>
<td>smtp.password</td>
<td>AUTH_EMAIL_PASSWD</td>
<td>SMTP_PASSWORD</td>
<td></td>
<td>smtp password</td>
<td>1.5.0</td>
</tr>
<tr>
<td>auth.email.tls</td>
<td>smtp.tls</td>
<td>AUTH_EMAIL_TLS</td>
<td>SMTP_TLS</td>
<td><code>false</code></td>
<td>enable TLS</td>
<td>1.5.0</td>
</tr>
<tr>
<td>auth.email.timeout</td>
<td>smtp.timeout</td>
<td>AUTH_EMAIL_TIMEOUT</td>
<td>SMTP_TIMEOUT</td>
<td><code>10s</code></td>
<td>smtp timeout</td>
<td>1.5.0</td>
</tr>
<tr>
<td>img-proxy</td>
<td>image-proxy.http2https</td>
<td>IMG_PROXY</td>
<td>IMAGE_PROXY_HTTP2HTTPS</td>
<td><code>false</code></td>
<td>enable http-&gt;https proxy for images</td>
<td>1.5.0</td>
</tr>
</tbody>
</table>
</details>
<h5><a id="user-content-required-parameters" class="anchor" aria-hidden="true" href="#required-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Required parameters</h5>
<p>Most of the parameters have sane defaults and don't require customization. There are only a few parameters user has to define:</p>
<ol>
<li><code>SECRET</code> - secret key, can be any long and hard-to-guess string.</li>
<li><code>REMARK_URL</code> - url pointing to your remark42 server, i.e. <code>https://demo.remark42.com</code></li>
<li>At least one pair of <code>AUTH_&lt;PROVIDER&gt;_CID</code> and <code>AUTH_&lt;PROVIDER&gt;_CSEC</code> defining oauth2 provider(s)</li>
</ol>
<p>The minimal <code>docker-compose.yml</code> has to include all required parameters:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">version</span>: <span class="pl-s"><span class="pl-pds">'</span>2<span class="pl-pds">'</span></span>

<span class="pl-ent">services</span>:
    <span class="pl-ent">remark42</span>:
        <span class="pl-ent">image</span>: <span class="pl-s">umputun/remark42:latest</span>
        <span class="pl-ent">restart</span>: <span class="pl-s">always</span>
        <span class="pl-ent">container_name</span>: <span class="pl-s"><span class="pl-pds">"</span>remark42<span class="pl-pds">"</span></span>
        <span class="pl-ent">environment</span>:
            - <span class="pl-s">REMARK_URL=https://demo.remark42.com  </span><span class="pl-c"><span class="pl-c">#</span> url pointing to your remark42 server</span>
            - <span class="pl-s">SITE=YOUR_SITE_ID                     </span><span class="pl-c"><span class="pl-c">#</span> site ID, same as used for `site_id`, see "Setup on your website"</span>
            - <span class="pl-s">SECRET=abcd-123456-xyz-$%^&amp;           </span><span class="pl-c"><span class="pl-c">#</span> secret key</span>
            - <span class="pl-s">AUTH_GITHUB_CID=12345667890           </span><span class="pl-c"><span class="pl-c">#</span> oauth2 client ID</span>
            - <span class="pl-s">AUTH_GITHUB_CSEC=abcdefg12345678      </span><span class="pl-c"><span class="pl-c">#</span> oauth2 client secret</span>
        <span class="pl-ent">volumes</span>:
            - <span class="pl-s">./var:/srv/var                        </span><span class="pl-c"><span class="pl-c">#</span> persistent volume to store all remark42 data</span></pre></div>
<h4><a id="user-content-quick-installation-test" class="anchor" aria-hidden="true" href="#quick-installation-test"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Quick installation test</h4>
<p>To verify if remark has been properly installed, check a demo page at <code>${REMARK_URL}/web</code> URL. Make sure to include <code>remark</code> site id to <code>${SITE}</code> list.</p>
<h4><a id="user-content-register-oauth2-providers" class="anchor" aria-hidden="true" href="#register-oauth2-providers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Register oauth2 providers</h4>
<p>Authentication handled by external providers. You should setup oauth2 for all (or some) of them to allow users to make comments. It is not mandatory to have all of them, but at least one should be correctly configured.</p>
<h5><a id="user-content-google-auth-provider" class="anchor" aria-hidden="true" href="#google-auth-provider"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Google Auth Provider</h5>
<ol>
<li>Create a new project: <a href="https://console.developers.google.com/project" rel="nofollow">https://console.developers.google.com/project</a></li>
<li>Choose the new project from the top right project dropdown (only if another project is selected)</li>
<li>In the project Dashboard center pane, choose <strong>"API Manager"</strong></li>
<li>In the left Nav pane, choose <strong>"Credentials"</strong></li>
<li>In the center pane, choose <strong>"OAuth consent screen"</strong> tab. Fill in <strong>"Product name shown to users"</strong> and hit save.</li>
<li>In the center pane, choose <strong>"Credentials"</strong> tab.
<ul>
<li>Open the <strong>"New credentials"</strong> drop down</li>
<li>Choose <strong>"OAuth client ID"</strong></li>
<li>Choose <strong>"Web application"</strong></li>
<li>Application name is freeform, choose something appropriate</li>
<li>Authorized origins is your domain ex: <code>https://remark42.mysite.com</code></li>
<li>Authorized redirect URIs is the location of oauth2/callback constructed as domain + <code>/auth/google/callback</code>, ex: <code>https://remark42.mysite.com/auth/google/callback</code></li>
<li>Choose <strong>"Create"</strong></li>
</ul>
</li>
<li>Take note of the <strong>Client ID</strong> and <strong>Client Secret</strong></li>
</ol>
<p><em>instructions for google oauth2 setup borrowed from <a href="https://github.com/bitly/oauth2_proxy">oauth2_proxy</a></em></p>
<h5><a id="user-content-github-auth-provider" class="anchor" aria-hidden="true" href="#github-auth-provider"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>GitHub Auth Provider</h5>
<ol>
<li>Create a new <strong>"OAuth App"</strong>: <a href="https://github.com/settings/developers">https://github.com/settings/developers</a></li>
<li>Fill <strong>"Application Name"</strong> and <strong>"Homepage URL"</strong> for your site</li>
<li>Under <strong>"Authorization callback URL"</strong> enter the correct url constructed as domain + <code>/auth/github/callback</code>. ie <code>https://remark42.mysite.com/auth/github/callback</code></li>
<li>Take note of the <strong>Client ID</strong> and <strong>Client Secret</strong></li>
</ol>
<h5><a id="user-content-facebook-auth-provider" class="anchor" aria-hidden="true" href="#facebook-auth-provider"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Facebook Auth Provider</h5>
<ol>
<li>From <a href="https://developers.facebook.com" rel="nofollow">https://developers.facebook.com</a> select <strong>"My Apps"</strong> / <strong>"Add a new App"</strong></li>
<li>Set <strong>"Display Name"</strong> and <strong>"Contact email"</strong></li>
<li>Choose <strong>"Facebook Login"</strong> and then <strong>"Web"</strong></li>
<li>Set "Site URL" to your domain, ex: <code>https://remark42.mysite.com</code></li>
<li>Under <strong>"Facebook login"</strong> / <strong>"Settings"</strong> fill "Valid OAuth redirect URIs" with your callback url constructed as domain + <code>/auth/facebook/callback</code></li>
<li>Select <strong>"App Review"</strong> and turn public flag on. This step may ask you to provide a link to your privacy policy.</li>
</ol>
<h5><a id="user-content-twitter-auth-provider" class="anchor" aria-hidden="true" href="#twitter-auth-provider"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Twitter Auth Provider</h5>
<ol>
<li>Create a new twitter application <a href="https://developer.twitter.com/en/apps" rel="nofollow">https://developer.twitter.com/en/apps</a></li>
<li>Fill <strong>App name</strong>, <strong>Description</strong> and <strong>URL</strong> of your site</li>
<li>In the field <strong>Callback URLs</strong> enter the correct url of your callback handler e.g.  domain + <code>/auth/twitter/callback</code></li>
<li>Under <strong>Key and tokens</strong> take note of the <strong>Consumer API Key</strong> and <strong>Consumer API Secret key</strong>. Those will be used as <code>AUTH_TWITTER_CID</code> and
<code>AUTH_TWITTER_CSEC</code></li>
</ol>
<h5><a id="user-content-yandex-auth-provider" class="anchor" aria-hidden="true" href="#yandex-auth-provider"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Yandex Auth Provider</h5>
<ol>
<li>Create a new <strong>"OAuth App"</strong>: <a href="https://oauth.yandex.com/client/new" rel="nofollow">https://oauth.yandex.com/client/new</a></li>
<li>Fill <strong>"App name"</strong> for your site</li>
<li>Under <strong>Platforms</strong> select <strong>"Web services"</strong> and enter <strong>"Callback URI #1"</strong> constructed as domain + <code>/auth/yandex/callback</code>. ie <code>https://remark42.mysite.com/auth/yandex/callback</code></li>
<li>Select <strong>Permissions</strong>. You need following permissions only from the <strong>"Yandex.Passport API"</strong> section:
<ul>
<li>Access to user avatar</li>
<li>Access to username, first name and surname, gender</li>
</ul>
</li>
<li>Fill out the rest of fields if needed</li>
<li>Take note of the <strong>ID</strong> and <strong>Password</strong></li>
</ol>
<p>For more details refer to <a href="https://tech.yandex.com/oauth/doc/dg/concepts/about-docpage/" rel="nofollow">Yandex OAuth</a> and <a href="https://tech.yandex.com/passport/doc/dg/index-docpage/" rel="nofollow">Yandex.Passport</a> API documentation.</p>
<h5><a id="user-content-anonymous-auth-provider" class="anchor" aria-hidden="true" href="#anonymous-auth-provider"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Anonymous Auth Provider</h5>
<p>Optionally, anonymous access can be turned on. In this case an extra <code>anonymous</code> provider will allow logins without any social login with any name satisfying 2 conditions:</p>
<ul>
<li>name should be at least 3 characters long</li>
<li>name has to start from the letter and contains letters, numbers, underscores and spaces only.</li>
</ul>
<h4><a id="user-content-initial-import-from-disqus" class="anchor" aria-hidden="true" href="#initial-import-from-disqus"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initial import from Disqus</h4>
<ol>
<li>Disqus provides an export of all comments on your site in a g-zipped file. This is found in your Moderation panel at Disqus Admin &gt; Setup &gt; Export. The export will be sent into a queue and then emailed to the address associated with your account once it's ready. Direct link to export will be something like <code>https://&lt;siteud&gt;.disqus.com/admin/discussions/export/</code>. See <a href="https://help.disqus.com/customer/portal/articles/1104797-importing-exporting" rel="nofollow">importing-exporting</a> for more details.</li>
<li>Move this file to your remark42 host within <code>./var</code> and unzip, i.e. <code>gunzip &lt;disqus-export-name&gt;.xml.gz</code>.</li>
<li>Run import command - <code>docker exec -it remark42 import -p disqus -f {disqus-export-name}.xml -s {your site id}</code></li>
</ol>
<h4><a id="user-content-initial-import-from-wordpress" class="anchor" aria-hidden="true" href="#initial-import-from-wordpress"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initial import from WordPress</h4>
<ol>
<li>Install WordPress <a href="https://wordpress.org/plugins/wp-exporter/" rel="nofollow">plugin</a> to export comments and follow it instructions. The plugin should produce a xml-based file with site content including comments.</li>
<li>Move this file to your remark42 host within <code>./var</code></li>
<li>Run import command - <code>docker exec -it remark42 import -p wordpress -f {wordpress-export-name}.xml -s {your site id}</code></li>
</ol>
<h4><a id="user-content-backup-and-restore" class="anchor" aria-hidden="true" href="#backup-and-restore"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Backup and restore</h4>
<h5><a id="user-content-automatic-backups" class="anchor" aria-hidden="true" href="#automatic-backups"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Automatic backups</h5>
<p>Remark42 by default makes daily backup files under <code>${BACKUP_PATH}</code> (default <code>./var/backup</code>). Backups kept up to <code>${MAX_BACKUP_FILES}</code> (default 10). Each backup file contains exported and gzipped content, i.e., all comments. At any point, the user can restore such backup and revert all comments to the desirable state. Note: restore procedure cleans the current data store and replaces all comments with comments from the backup file.</p>
<p>For safety and security reasons restore functionality not exposed outside of your server by default. The recommended way to restore from the backup is to use provided <code>scripts/restore-backup.sh</code>. It can run inside the container:</p>
<p><code>docker exec -it remark42 restore -f {backup-filename.gz} -s {your site id}</code></p>
<h5><a id="user-content-manual-backup" class="anchor" aria-hidden="true" href="#manual-backup"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Manual backup</h5>
<p>In addition to automatic backups user can make a backup manually. This command makes <code>userbackup-{site id}-{timestamp}.gz</code> by default.</p>
<p><code>docker exec -it remark42 backup -s {your site id}</code></p>
<h5><a id="user-content-restore-from-backup" class="anchor" aria-hidden="true" href="#restore-from-backup"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Restore from backup</h5>
<p>Restore will clean all comments first and then will processed with complete import from a given file.</p>
<p><code>docker exec -it remark42 restore -f {backup file name} -s {your site id}</code></p>
<h5><a id="user-content-backup-format" class="anchor" aria-hidden="true" href="#backup-format"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Backup format</h5>
<p>Backup file is a text file with all exported comments separated by EOL. Each backup record is a valid json with all key/value
unmarshaled from <code>Comment</code> struct (see below).</p>
<h4><a id="user-content-admin-users" class="anchor" aria-hidden="true" href="#admin-users"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Admin users</h4>
<p>Admins/moderators should be defined in <code>docker-compose.yml</code> as a list of user IDs or passed in the command line.</p>
<pre><code>    environment:
        - ADMIN_SHARED_ID=github_ef0f706a79cc24b17bbbb374cd234a691a034128,github_dae9983158e9e5e127ef2b87a411ef13c891e9e5
</code></pre>
<p>To get user id just login and click on your username or any other user you want to promote to admins.
It will expand login info and show full user ID.</p>
<h4><a id="user-content-docker-parameters" class="anchor" aria-hidden="true" href="#docker-parameters"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Docker parameters</h4>
<p>Two parameters allow customizing Docker container on the system level:</p>
<ul>
<li><code>APP_UID</code> - sets UID to run remark42 application in container (default=1001)</li>
<li><code>TIME_ZONE</code> - sets time zone of remark42 container (default=America/Chicago)</li>
</ul>
<p><em>see <a href="https://github.com/umputun/baseimage">umputun/baseimage</a> for more details</em></p>
<p>example of <code>docker-compose.yml</code>:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-ent">version</span>: <span class="pl-s"><span class="pl-pds">'</span>2<span class="pl-pds">'</span></span>

<span class="pl-ent">services</span>:
    <span class="pl-ent">remark42</span>:
        <span class="pl-ent">image</span>: <span class="pl-s">umputun/remark42:latest</span>
        <span class="pl-ent">restart</span>: <span class="pl-s">always</span>
        <span class="pl-ent">container_name</span>: <span class="pl-s"><span class="pl-pds">"</span>remark42<span class="pl-pds">"</span></span>
        <span class="pl-ent">environment</span>:
            - <span class="pl-s">APP_UID=2000                          </span><span class="pl-c"><span class="pl-c">#</span> runs remark42 app with non-default UID</span>
            - <span class="pl-s">TIME_ZONE=GTC                         </span><span class="pl-c"><span class="pl-c">#</span> sets container time to UTC</span>

            - <span class="pl-s">REMARK_URL=https://demo.remark42.com  </span><span class="pl-c"><span class="pl-c">#</span> url pointing to your remark42 server</span>
            - <span class="pl-s">SITE=YOUR_SITE_ID                     </span><span class="pl-c"><span class="pl-c">#</span> site ID, same as used for `site_id`, see "Setup on your website"</span>
            - <span class="pl-s">SECRET=abcd-123456-xyz-$%^&amp;           </span><span class="pl-c"><span class="pl-c">#</span> secret key</span>
            - <span class="pl-s">AUTH_GITHUB_CID=12345667890           </span><span class="pl-c"><span class="pl-c">#</span> oauth2 client ID</span>
            - <span class="pl-s">AUTH_GITHUB_CSEC=abcdefg12345678      </span><span class="pl-c"><span class="pl-c">#</span> oauth2 client secret</span>
        <span class="pl-ent">volumes</span>:
            - <span class="pl-s">./var:/srv/var                        </span><span class="pl-c"><span class="pl-c">#</span> persistent volume to store all remark42 data</span></pre></div>
<h3><a id="user-content-setup-on-your-website" class="anchor" aria-hidden="true" href="#setup-on-your-website"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setup on your website</h3>
<h4><a id="user-content-comments" class="anchor" aria-hidden="true" href="#comments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Comments</h4>
<p>It's a main widget which renders list of comments.</p>
<p>Add this snippet to the bottom of web page:</p>
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
  <span class="pl-k">var</span> <span class="pl-s1">remark_config</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
    <span class="pl-c1">host</span>: <span class="pl-s">"REMARK_URL"</span><span class="pl-kos">,</span> <span class="pl-c">// hostname of remark server, same as REMARK_URL in backend config, e.g. "https://demo.remark42.com"</span>
    <span class="pl-c1">site_id</span>: <span class="pl-s">'YOUR_SITE_ID'</span><span class="pl-kos">,</span>
    <span class="pl-c1">components</span>: <span class="pl-kos">[</span><span class="pl-s">'embed'</span><span class="pl-kos">]</span><span class="pl-kos">,</span> <span class="pl-c">// optional param; which components to load. default to ["embed"]</span>
                           <span class="pl-c">// to load all components define components as ['embed', 'last-comments', 'counter']</span>
                           <span class="pl-c">// available component are:</span>
                           <span class="pl-c">//     - 'embed': basic comments widget</span>
                           <span class="pl-c">//     - 'last-comments': last comments widget, see `Last Comments` section below</span>
                           <span class="pl-c">//     - 'counter': counter widget, see `Counter` section below</span>
    <span class="pl-c1">url</span>: <span class="pl-s">'PAGE_URL'</span><span class="pl-kos">,</span> <span class="pl-c">// optional param; if it isn't defined</span>
                     <span class="pl-c">// `window.location.origin + window.location.pathname` will be used,</span>
                     <span class="pl-c">//</span>
                     <span class="pl-c">// Note that if you use query parameters as significant part of url</span>
                     <span class="pl-c">// (the one that actually changes content on page)</span>
                     <span class="pl-c">// you will have to configure url manually to keep query params, as</span>
                     <span class="pl-c">// `window.location.origin + window.location.pathname` doesn't contain query params and</span>
                     <span class="pl-c">// hash. For example default url for `https://example/com/example-post?id=1#hash`</span>
                     <span class="pl-c">// would be `https://example/com/example-post`.</span>
                     <span class="pl-c">//</span>
                     <span class="pl-c">// The problem with query params is that they often contain useless params added by</span>
                     <span class="pl-c">// various trackers (utm params) and doesn't have defined order, so Remark treats differently</span>
                     <span class="pl-c">// all this examples:</span>
                     <span class="pl-c">// https://example.com/?postid=1&amp;date=2007-02-11</span>
                     <span class="pl-c">// https://example.com/?date=2007-02-11&amp;postid=1</span>
                     <span class="pl-c">// https://example.com/?date=2007-02-11&amp;postid=1&amp;utm_source=google</span>
                     <span class="pl-c">//</span>
                     <span class="pl-c">// If you deal with query parameters make sure you pass only significant part of it</span>
                     <span class="pl-c">// in well defined order</span>
    <span class="pl-c1">max_shown_comments</span>: <span class="pl-c1">10</span><span class="pl-kos">,</span> <span class="pl-c">// optional param; if it isn't defined default value (15) will be used</span>
    <span class="pl-c1">theme</span>: <span class="pl-s">'dark'</span><span class="pl-kos">,</span> <span class="pl-c">// optional param; if it isn't defined default value ('light') will be used</span>
    <span class="pl-c1">page_title</span>: <span class="pl-s">'Moving to Remark42'</span><span class="pl-kos">,</span> <span class="pl-c">// optional param; if it isn't defined `document.title` will be used</span>
    <span class="pl-c1">locale</span>: <span class="pl-s">'en'</span> <span class="pl-c">// set up locale and language, if it isn't defined default value ('en') will be used</span>
  <span class="pl-kos">}</span><span class="pl-kos">;</span>

  <span class="pl-kos">(</span><span class="pl-k">function</span><span class="pl-kos">(</span><span class="pl-s1">c</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">for</span><span class="pl-kos">(</span><span class="pl-k">var</span> <span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span><span class="pl-kos">;</span> <span class="pl-s1">i</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">c</span><span class="pl-kos">.</span><span class="pl-c1">length</span><span class="pl-kos">;</span> <span class="pl-s1">i</span><span class="pl-c1">++</span><span class="pl-kos">)</span><span class="pl-kos">{</span>
      <span class="pl-k">var</span> <span class="pl-s1">d</span> <span class="pl-c1">=</span> <span class="pl-smi">document</span><span class="pl-kos">,</span> <span class="pl-s1">s</span> <span class="pl-c1">=</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-en">createElement</span><span class="pl-kos">(</span><span class="pl-s">'script'</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-s1">s</span><span class="pl-kos">.</span><span class="pl-c1">src</span> <span class="pl-c1">=</span> <span class="pl-s1">remark_config</span><span class="pl-kos">.</span><span class="pl-c1">host</span> <span class="pl-c1">+</span> <span class="pl-s">'/web/'</span> <span class="pl-c1">+</span><span class="pl-s1">c</span><span class="pl-kos">[</span><span class="pl-s1">i</span><span class="pl-kos">]</span> <span class="pl-c1">+</span><span class="pl-s">'.js'</span><span class="pl-kos">;</span>
      <span class="pl-s1">s</span><span class="pl-kos">.</span><span class="pl-c1">defer</span> <span class="pl-c1">=</span> <span class="pl-c1">true</span><span class="pl-kos">;</span>
      <span class="pl-kos">(</span><span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">head</span> <span class="pl-c1">||</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">body</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">appendChild</span><span class="pl-kos">(</span><span class="pl-s1">s</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-s1">remark_config</span><span class="pl-kos">.</span><span class="pl-c1">components</span> <span class="pl-c1">||</span> <span class="pl-kos">[</span><span class="pl-s">'embed'</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p>And then add this node in the place where you want to see Remark42 widget:</p>
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">div</span> <span class="pl-c1">id</span>="<span class="pl-s">remark42</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">div</span><span class="pl-kos">&gt;</span></pre></div>
<p>After that widget will be rendered inside this node.</p>
<h5><a id="user-content-themes" class="anchor" aria-hidden="true" href="#themes"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Themes</h5>
<p>Right now Remark has two themes: light and dark.
You can pick one using configuration object,
but there is also a possibility to switch between themes in runtime.
For this purpose Remark adds to <code>window</code> object named <code>REMARK42</code>,
which contains function <code>changeTheme</code>.
Just call this function and pass a name of the theme that you want to turn on:</p>
<div class="highlight highlight-source-js"><pre><span class="pl-smi">window</span><span class="pl-kos">.</span><span class="pl-c1">REMARK42</span><span class="pl-kos">.</span><span class="pl-en">changeTheme</span><span class="pl-kos">(</span><span class="pl-s">'light'</span><span class="pl-kos">)</span><span class="pl-kos">;</span></pre></div>
<h5><a id="user-content-locales" class="anchor" aria-hidden="true" href="#locales"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Locales</h5>
<p>Right now Remark is translated to en, ru (partially), de, and fi languages.
You can pick one using <a href="#setup-on-your-website">configuration object</a>.</p>
<p>Do you want translate remark42 to other locale? Please see <a href="https://github.com/umputun/remark42/blob/master/docs/translation.md">this documentation</a> for details.</p>
<h4><a id="user-content-last-comments" class="anchor" aria-hidden="true" href="#last-comments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Last comments</h4>
<p>It's a widget which renders list of last comments from your site.</p>
<p>Add this snippet to the bottom of web page, or adjust already present <code>remark_config</code> to have <code>last-comments</code> in <code>components</code> list:</p>
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
  <span class="pl-k">var</span> <span class="pl-s1">remark_config</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
    <span class="pl-c1">host</span>: <span class="pl-s">"REMARK_URL"</span><span class="pl-kos">,</span> <span class="pl-c">// hostname of remark server, same as REMARK_URL in backend config, e.g. "https://demo.remark42.com"</span>
    <span class="pl-c1">site_id</span>: <span class="pl-s">'YOUR_SITE_ID'</span><span class="pl-kos">,</span>
    <span class="pl-c1">components</span>: <span class="pl-kos">[</span><span class="pl-s">'last-comments'</span><span class="pl-kos">]</span>
  <span class="pl-kos">}</span><span class="pl-kos">;</span>

  <span class="pl-kos">(</span><span class="pl-k">function</span><span class="pl-kos">(</span><span class="pl-s1">c</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">for</span><span class="pl-kos">(</span><span class="pl-k">var</span> <span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span><span class="pl-kos">;</span> <span class="pl-s1">i</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">c</span><span class="pl-kos">.</span><span class="pl-c1">length</span><span class="pl-kos">;</span> <span class="pl-s1">i</span><span class="pl-c1">++</span><span class="pl-kos">)</span><span class="pl-kos">{</span>
      <span class="pl-k">var</span> <span class="pl-s1">d</span> <span class="pl-c1">=</span> <span class="pl-smi">document</span><span class="pl-kos">,</span> <span class="pl-s1">s</span> <span class="pl-c1">=</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-en">createElement</span><span class="pl-kos">(</span><span class="pl-s">'script'</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-s1">s</span><span class="pl-kos">.</span><span class="pl-c1">src</span> <span class="pl-c1">=</span> <span class="pl-s1">remark_config</span><span class="pl-kos">.</span><span class="pl-c1">host</span> <span class="pl-c1">+</span> <span class="pl-s">'/web/'</span> <span class="pl-c1">+</span><span class="pl-s1">c</span><span class="pl-kos">[</span><span class="pl-s1">i</span><span class="pl-kos">]</span> <span class="pl-c1">+</span><span class="pl-s">'.js'</span><span class="pl-kos">;</span>
      <span class="pl-s1">s</span><span class="pl-kos">.</span><span class="pl-c1">defer</span> <span class="pl-c1">=</span> <span class="pl-c1">true</span><span class="pl-kos">;</span>
      <span class="pl-kos">(</span><span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">head</span> <span class="pl-c1">||</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">body</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">appendChild</span><span class="pl-kos">(</span><span class="pl-s1">s</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-s1">remark_config</span><span class="pl-kos">.</span><span class="pl-c1">components</span> <span class="pl-c1">||</span> <span class="pl-kos">[</span><span class="pl-s">'embed'</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p>And then add this node in the place where you want to see last comments widget:</p>
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">div</span> <span class="pl-c1">class</span>="<span class="pl-s">remark42__last-comments</span>" <span class="pl-c1">data-max</span>="<span class="pl-s">50</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">div</span><span class="pl-kos">&gt;</span></pre></div>
<p><code>data-max</code> sets the max amount of comments (default: <code>15</code>).</p>
<h4><a id="user-content-counter" class="anchor" aria-hidden="true" href="#counter"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Counter</h4>
<p>It's a widget which renders a number of comments for the specified page.</p>
<p>Add this snippet to the bottom of web page, or adjust already present <code>remark_config</code> to have <code>counter</code> in <code>components</code> list:</p>
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span>
  <span class="pl-k">var</span> <span class="pl-s1">remark_config</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span>
    <span class="pl-c1">host</span>: <span class="pl-s">"REMARK_URL"</span><span class="pl-kos">,</span> <span class="pl-c">// hostname of remark server, same as REMARK_URL in backend config, e.g. "https://demo.remark42.com"</span>
    <span class="pl-c1">site_id</span>: <span class="pl-s">'YOUR_SITE_ID'</span><span class="pl-kos">,</span>
    <span class="pl-c1">components</span>: <span class="pl-kos">[</span><span class="pl-s">'counter'</span><span class="pl-kos">]</span>
  <span class="pl-kos">}</span><span class="pl-kos">;</span>

  <span class="pl-kos">(</span><span class="pl-k">function</span><span class="pl-kos">(</span><span class="pl-s1">c</span><span class="pl-kos">)</span> <span class="pl-kos">{</span>
    <span class="pl-k">for</span><span class="pl-kos">(</span><span class="pl-k">var</span> <span class="pl-s1">i</span> <span class="pl-c1">=</span> <span class="pl-c1">0</span><span class="pl-kos">;</span> <span class="pl-s1">i</span> <span class="pl-c1">&lt;</span> <span class="pl-s1">c</span><span class="pl-kos">.</span><span class="pl-c1">length</span><span class="pl-kos">;</span> <span class="pl-s1">i</span><span class="pl-c1">++</span><span class="pl-kos">)</span><span class="pl-kos">{</span>
      <span class="pl-k">var</span> <span class="pl-s1">d</span> <span class="pl-c1">=</span> <span class="pl-smi">document</span><span class="pl-kos">,</span> <span class="pl-s1">s</span> <span class="pl-c1">=</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-en">createElement</span><span class="pl-kos">(</span><span class="pl-s">'script'</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
      <span class="pl-s1">s</span><span class="pl-kos">.</span><span class="pl-c1">src</span> <span class="pl-c1">=</span> <span class="pl-s1">remark_config</span><span class="pl-kos">.</span><span class="pl-c1">host</span> <span class="pl-c1">+</span> <span class="pl-s">'/web/'</span> <span class="pl-c1">+</span><span class="pl-s1">c</span><span class="pl-kos">[</span><span class="pl-s1">i</span><span class="pl-kos">]</span> <span class="pl-c1">+</span><span class="pl-s">'.js'</span><span class="pl-kos">;</span>
      <span class="pl-s1">s</span><span class="pl-kos">.</span><span class="pl-c1">defer</span> <span class="pl-c1">=</span> <span class="pl-c1">true</span><span class="pl-kos">;</span>
      <span class="pl-kos">(</span><span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">head</span> <span class="pl-c1">||</span> <span class="pl-s1">d</span><span class="pl-kos">.</span><span class="pl-c1">body</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">appendChild</span><span class="pl-kos">(</span><span class="pl-s1">s</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
    <span class="pl-kos">}</span>
  <span class="pl-kos">}</span><span class="pl-kos">)</span><span class="pl-kos">(</span><span class="pl-s1">remark_config</span><span class="pl-kos">.</span><span class="pl-c1">components</span> <span class="pl-c1">||</span> <span class="pl-kos">[</span><span class="pl-s">'embed'</span><span class="pl-kos">]</span><span class="pl-kos">)</span><span class="pl-kos">;</span>
<span class="pl-kos">&lt;/</span><span class="pl-ent">script</span><span class="pl-kos">&gt;</span></pre></div>
<p>And then add a node like this in the place where you want to see a number of comments:</p>
<div class="highlight highlight-text-html-basic"><pre><span class="pl-kos">&lt;</span><span class="pl-ent">span</span> <span class="pl-c1">class</span>="<span class="pl-s">remark42__counter</span>" <span class="pl-c1">data-url</span>="<span class="pl-s">https://domain.com/path/to/article/</span>"<span class="pl-kos">&gt;</span><span class="pl-kos">&lt;/</span><span class="pl-ent">span</span><span class="pl-kos">&gt;</span></pre></div>
<p>You can use as many nodes like this as you need to.
The script will found all them by the class <code>remark__counter</code>,
and it will use <code>data-url</code> attribute to define the page with comments.</p>
<p>Also script can use <code>url</code> property from <code>remark_config</code> object, or <code>window.location.origin + window.location.pathname</code> if nothing else is defined.</p>
<h2><a id="user-content-build-from-the-source" class="anchor" aria-hidden="true" href="#build-from-the-source"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Build from the source</h2>
<ul>
<li>to build Docker container - <code>make docker</code>. This command will produce container <code>umputun/remark42</code>.</li>
<li>to build a single binary for direct execution - <code>make OS=&lt;linux|windows|darwin&gt; ARCH=&lt;amd64|386&gt;</code>. This step will produce executable
<code>remark42</code> file with everything embedded.</li>
</ul>
<h2><a id="user-content-development" class="anchor" aria-hidden="true" href="#development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Development</h2>
<p>You can use fully functional local version to develop and test both frontend &amp; backend. It requires at least 2GB RAM or swap enabled</p>
<p>To bring it up run:</p>
<div class="highlight highlight-source-shell"><pre><span class="pl-c"><span class="pl-c">#</span> if you mainly work on backend</span>
docker-compose -f compose-dev-backend.yml build
docker-compose -f compose-dev-backend.yml up
<span class="pl-c"><span class="pl-c">#</span> if you mainly work on frontend</span>
docker-compose -f compose-dev-frontend.yml build
docker-compose -f compose-dev-frontend.yml up</pre></div>
<p>It starts Remark42 on <code>127.0.0.1:8080</code> and adds local OAuth2 provider Dev.
To access UI demo page go to <code>127.0.0.1:8080/web</code>.
By default, you would be logged in as <code>dev_user</code> which defined as admin.
You can tweak any of <a href="#Parameters">supported parameters</a> in corresponded yml file.</p>
<p>Backend Docker Compose config by default skips running frontend related tests.
Frontend Docker Compose config by default skips running backend related tests and sets <code>NODE_ENV=development</code> for frontend build.</p>
<h3><a id="user-content-backend-development" class="anchor" aria-hidden="true" href="#backend-development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Backend development</h3>
<p>In order to run backend locally (development mode, without Docker) you have to have the latest stable <code>go</code> toolchain <a href="https://golang.org/doc/install" rel="nofollow">installed</a>.</p>
<p>To run backend - <code>cd backend; go run app/main.go server --dbg --secret=12345 --url=http://127.0.0.1:8080 --admin-passwd=password --site=remark</code>
It stars backend service with embedded bolt store on port <code>8080</code> with basic auth, allowing to authenticate and run requests directly, like this:
<code>HTTP http://admin:password@127.0.0.1:8080/api/v1/find?site=remark&amp;sort=-active&amp;format=tree&amp;url=http://127.0.0.1:8080</code></p>
<h3><a id="user-content-frontend-development" class="anchor" aria-hidden="true" href="#frontend-development"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Frontend development</h3>
<h4><a id="user-content-developer-guide" class="anchor" aria-hidden="true" href="#developer-guide"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Developer guide</h4>
<p>Frontend guide can be found here: <a href="./frontend/Readme.md">./frontend/Readme.md</a></p>
<h4><a id="user-content-build" class="anchor" aria-hidden="true" href="#build"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Build</h4>
<p>You should have at least 2GB RAM or swap enabled for building</p>
<ul>
<li>install <a href="https://nodejs.org/en/" rel="nofollow">Node.js 12.11</a> or higher;</li>
<li>install <a href="https://www.npmjs.com/package/npm" rel="nofollow">NPM 6.13.4</a>;</li>
<li>run <code>npm install</code> inside <code>./frontend</code>;</li>
<li>run <code>npm run build</code> there;</li>
<li>result files will be saved in <code>./frontend/public</code>.</li>
</ul>
<p><strong>Note</strong> Running <code>npm install</code> will set up precommit hooks into your git repository.
It used to reformat your frontend code using <code>prettier</code> and lint with <code>eslint</code> and <code>stylelint</code> before every commit.</p>
<h4><a id="user-content-devserver" class="anchor" aria-hidden="true" href="#devserver"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Devserver</h4>
<p>For local development mode with Hot Reloading use <code>npm start</code> instead of <code>npm run build</code>.
In this case <code>webpack</code> will serve files using <code>webpack-dev-server</code> on <code>localhost:9000</code>.
By visiting <code>127.0.0.1:9000/web</code> you will get a page with main comments widget
communicating with demo server backend running on <code>https://demo.remark42.com</code>.
But you will not be able to login with any oauth providers due to security reasons.</p>
<p>You can attach to locally running backend by providing <code>REMARK_URL</code> environment variable.</p>
<div class="highlight highlight-source-shell"><pre>npx cross-env REMARK_URL=http://127.0.0.1:8080 npm start</pre></div>
<p>The best way for start local developer enviroment:</p>
<div class="highlight highlight-source-shell"><pre>cp compose-dev-frontend.yml compose-private-frontend.yml
docker-compose -f compose-private-frontend.yml up --build
<span class="pl-c1">cd</span> frontend
npm run dev</pre></div>
<p>Developer build running by <code>webpack-dev-server</code> supports devtools for <a href="https://github.com/facebook/react-devtools">React</a> and
<a href="https://github.com/zalmoxisus/redux-devtools-extension">Redux</a>.</p>
<h2><a id="user-content-api" class="anchor" aria-hidden="true" href="#api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>API</h2>
<h3><a id="user-content-authorization" class="anchor" aria-hidden="true" href="#authorization"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Authorization</h3>
<ul>
<li><code>GET /auth/{provider}/login?from=http://url&amp;site=site_id&amp;session=1</code> - perform "social" login with one of supported providers and redirect to <code>url</code>. Presence of <code>session</code> (any non-zero value) change the default cookie expiration and makes them session-only.</li>
<li><code>GET /auth/logout</code> - logout</li>
</ul>
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">User</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">Name</span>    <span class="pl-smi">string</span> <span class="pl-s">`json:"name"`</span>
    <span class="pl-c1">ID</span>      <span class="pl-smi">string</span> <span class="pl-s">`json:"id"`</span>
    <span class="pl-c1">Picture</span> <span class="pl-smi">string</span> <span class="pl-s">`json:"picture"`</span>
    <span class="pl-c1">Admin</span>   <span class="pl-smi">bool</span>   <span class="pl-s">`json:"admin"`</span>
    <span class="pl-c1">Blocked</span> <span class="pl-smi">bool</span>   <span class="pl-s">`json:"block"`</span>
    <span class="pl-c1">Verified</span> <span class="pl-smi">bool</span>  <span class="pl-s">`json:"verified"`</span>
}</pre></div>
<p><em>currently supported providers are <code>google</code>, <code>facebook</code>, <code>github</code> and <code>yandex</code></em></p>
<h3><a id="user-content-commenting" class="anchor" aria-hidden="true" href="#commenting"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Commenting</h3>
<ul>
<li><code>POST /api/v1/comment</code> - add a comment. <em>auth required</em></li>
</ul>
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">Comment</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">ID</span>        <span class="pl-smi">string</span>          <span class="pl-s">`json:"id"`</span>      <span class="pl-c">// comment ID, read only</span>
    <span class="pl-c1">ParentID</span>  <span class="pl-smi">string</span>          <span class="pl-s">`json:"pid"`</span>     <span class="pl-c">// parent ID</span>
    <span class="pl-c1">Text</span>      <span class="pl-smi">string</span>          <span class="pl-s">`json:"text"`</span>    <span class="pl-c">// comment text, after md processing</span>
    <span class="pl-c1">Orig</span>      <span class="pl-smi">string</span>          <span class="pl-s">`json:"orig"`</span>    <span class="pl-c">// original comment text</span>
    <span class="pl-c1">User</span>      <span class="pl-smi">User</span>            <span class="pl-s">`json:"user"`</span>    <span class="pl-c">// user info, read only</span>
    <span class="pl-c1">Locator</span>   <span class="pl-smi">Locator</span>         <span class="pl-s">`json:"locator"`</span> <span class="pl-c">// post locator</span>
    <span class="pl-c1">Score</span>     <span class="pl-smi">int</span>             <span class="pl-s">`json:"score"`</span>   <span class="pl-c">// comment score, read only</span>
    <span class="pl-c1">Vote</span>      <span class="pl-smi">int</span>             <span class="pl-s">`json:"vote"`</span>    <span class="pl-c">// vote for the current user, -1/1/0.</span>
    <span class="pl-c1">Controversy</span> <span class="pl-smi">float64</span>       <span class="pl-s">`json:"controversy,omitempty"`</span> <span class="pl-c">// comment controversy, read only</span>
    <span class="pl-c1">Timestamp</span> time.<span class="pl-smi">Time</span>       <span class="pl-s">`json:"time"`</span>    <span class="pl-c">// time stamp, read only</span>
    <span class="pl-c1">Edit</span>      <span class="pl-c1">*</span><span class="pl-smi">Edit</span>           <span class="pl-s">`json:"edit,omitempty" bson:"edit,omitempty"`</span> <span class="pl-c">// pointer to have empty default in json response</span>
    <span class="pl-c1">Pin</span>       <span class="pl-smi">bool</span>            <span class="pl-s">`json:"pin"`</span>     <span class="pl-c">// pinned status, read only</span>
    <span class="pl-c1">Delete</span>    <span class="pl-smi">bool</span>            <span class="pl-s">`json:"delete"`</span>  <span class="pl-c">// delete status, read only</span>
    <span class="pl-c1">PostTitle</span> <span class="pl-smi">string</span>          <span class="pl-s">`json:"title"`</span>   <span class="pl-c">// post title</span>
}

<span class="pl-k">type</span> <span class="pl-smi">Locator</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">SiteID</span> <span class="pl-smi">string</span> <span class="pl-s">`json:"site"`</span>     <span class="pl-c">// site id</span>
    <span class="pl-c1">URL</span>    <span class="pl-smi">string</span> <span class="pl-s">`json:"url"`</span>      <span class="pl-c">// post url</span>
}

<span class="pl-k">type</span> <span class="pl-smi">Edit</span> <span class="pl-k">struct</span> {
  <span class="pl-c1">Timestamp</span> time.<span class="pl-smi">Time</span> <span class="pl-s">`json:"time" bson:"time"`</span>
  <span class="pl-c1">Summary</span>   <span class="pl-smi">string</span>    <span class="pl-s">`json:"summary"`</span>
}</pre></div>
<ul>
<li>
<p><code>POST /api/v1/preview</code> - preview comment in html. Body is <code>Comment</code> to render</p>
</li>
<li>
<p><code>GET /api/v1/find?site=site-id&amp;url=post-url&amp;sort=fld&amp;format=tree|plain</code> - find all comments for given post</p>
</li>
</ul>
<p>This is the primary call used by UI to show comments for given post. It can return comments in two formats - <code>plain</code> and <code>tree</code>.
In plain format result will be sorted list of <code>Comment</code>. In tree format this is going to be tree-like object with this structure:</p>
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">Tree</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">Nodes</span> []<span class="pl-smi">Node</span> <span class="pl-s">`json:"comments"`</span>
    <span class="pl-c1">Info</span>  store.<span class="pl-smi">PostInfo</span> <span class="pl-s">`json:"info,omitempty"`</span>
}

<span class="pl-k">type</span> <span class="pl-smi">Node</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">Comment</span> store.<span class="pl-smi">Comment</span> <span class="pl-s">`json:"comment"`</span>
    <span class="pl-c1">Replies</span> []<span class="pl-smi">Node</span>        <span class="pl-s">`json:"replies,omitempty"`</span>
}</pre></div>
<p>Sort can be <code>time</code>, <code>active</code> or <code>score</code>. Supported sort order with prefix -/+, i.e. <code>-time</code>. For <code>tree</code> mode sort will be applied to top-level comments only and all replies always sorted by time.</p>
<ul>
<li><code>PUT /api/v1/comment/{id}?site=site-id&amp;url=post-url</code> - edit comment, allowed once in <code>EDIT_TIME</code> minutes since creation.  Body is <code>EditRequest</code> json</li>
</ul>
<div class="highlight highlight-source-go"><pre>   <span class="pl-k">type</span> <span class="pl-smi">EditRequest</span> <span class="pl-k">struct</span> {
     <span class="pl-c1">Text</span>    <span class="pl-smi">string</span> <span class="pl-s">`json:"text"`</span>    <span class="pl-c">// updated text</span>
     <span class="pl-c1">Summary</span> <span class="pl-smi">string</span> <span class="pl-s">`json:"summary"`</span> <span class="pl-c">// optional, summary of the edit</span>
     <span class="pl-c1">Delete</span>  <span class="pl-smi">bool</span>   <span class="pl-s">`json:"delete"`</span>  <span class="pl-c">// delete flag</span>
   }{}</pre></div>
<ul>
<li>
<p><code>GET /api/v1/last/{max}?site=site-id&amp;since=ts-msec</code> - get up to <code>{max}</code> last comments, <code>since</code> (epoch time, milliseconds) is optional</p>
</li>
<li>
<p><code>GET /api/v1/id/{id}?site=site-id</code> - get comment by <code>comment id</code></p>
</li>
<li>
<p><code>GET /api/v1/comments?site=site-id&amp;user=id&amp;limit=N</code> - get comment by <code>user id</code>, returns <code>response</code> object</p>
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">response</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">Comments</span> []store.<span class="pl-smi">Comment</span>  <span class="pl-s">`json:"comments"`</span>
    <span class="pl-c1">Count</span>    <span class="pl-smi">int</span>              <span class="pl-s">`json:"count"`</span>
}{}</pre></div>
</li>
<li>
<p><code>GET /api/v1/count?site=site-id&amp;url=post-url</code> - get comment's count for <code>{url}</code></p>
</li>
<li>
<p><code>POST /api/v1/count?site=siteID</code> - get number of comments for posts from post body (list of post IDs)</p>
</li>
<li>
<p><code>GET /api/v1/list?site=site-id&amp;limit=5&amp;skip=2</code> - list commented posts, returns array or <code>PostInfo</code>, limit=0 will return all posts</p>
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">PostInfo</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">URL</span>   <span class="pl-smi">string</span>      <span class="pl-s">`json:"url"`</span>
    <span class="pl-c1">Count</span> <span class="pl-smi">int</span>         <span class="pl-s">`json:"count"`</span>
    <span class="pl-c1">ReadOnly</span> <span class="pl-smi">bool</span>     <span class="pl-s">`json:"read_only,omitempty"`</span>
    <span class="pl-c1">FirstTS</span> time.<span class="pl-smi">Time</span> <span class="pl-s">`json:"first_time,omitempty"`</span>
    <span class="pl-c1">LastTS</span>  time.<span class="pl-smi">Time</span> <span class="pl-s">`json:"last_time,omitempty"`</span>
}</pre></div>
</li>
<li>
<p><code>GET /api/v1/user</code> - get user info, <em>auth required</em></p>
</li>
<li>
<p><code>PUT /api/v1/vote/{id}?site=site-id&amp;url=post-url&amp;vote=1</code> - vote for comment. <code>vote</code>=1 will increase score, -1 decrease. <em>auth required</em></p>
</li>
<li>
<p><code>GET /api/v1/userdata?site=site-id</code> - export all user data to gz stream  <em>auth required</em></p>
</li>
<li>
<p><code>POST /api/v1/deleteme?site=site-id</code> - request deletion of user data. <em>auth required</em></p>
</li>
<li>
<p><code>GET /api/v1/config?site=site-id</code> - returns configuration (parameters) for given site</p>
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">Config</span> <span class="pl-k">struct</span> {
      <span class="pl-c1">Version</span>        <span class="pl-smi">string</span>   <span class="pl-s">`json:"version"`</span>
      <span class="pl-c1">EditDuration</span>   <span class="pl-smi">int</span>      <span class="pl-s">`json:"edit_duration"`</span>
      <span class="pl-c1">MaxCommentSize</span> <span class="pl-smi">int</span>      <span class="pl-s">`json:"max_comment_size"`</span>
      <span class="pl-c1">Admins</span>         []<span class="pl-smi">string</span> <span class="pl-s">`json:"admins"`</span>
      <span class="pl-c1">AdminEmail</span>     <span class="pl-smi">string</span>   <span class="pl-s">`json:"admin_email"`</span>
      <span class="pl-c1">Auth</span>           []<span class="pl-smi">string</span> <span class="pl-s">`json:"auth_providers"`</span>
      <span class="pl-c1">LowScore</span>       <span class="pl-smi">int</span>      <span class="pl-s">`json:"low_score"`</span>
      <span class="pl-c1">CriticalScore</span>  <span class="pl-smi">int</span>      <span class="pl-s">`json:"critical_score"`</span>
      <span class="pl-c1">PositiveScore</span>  <span class="pl-smi">bool</span>     <span class="pl-s">`json:"positive_score"`</span>
      <span class="pl-c1">ReadOnlyAge</span>    <span class="pl-smi">int</span>      <span class="pl-s">`json:"readonly_age"`</span>
      <span class="pl-c1">MaxImageSize</span>   <span class="pl-smi">int</span>      <span class="pl-s">`json:"max_image_size"`</span>
      <span class="pl-c1">EmojiEnabled</span>   <span class="pl-smi">bool</span>     <span class="pl-s">`json:"emoji_enabled"`</span>
}</pre></div>
</li>
<li>
<p><code>GET /api/v1/info?site=site-idd&amp;url=post-url</code> - returns <code>PostInfo</code> for site and url</p>
</li>
</ul>
<h3><a id="user-content-streaming-api" class="anchor" aria-hidden="true" href="#streaming-api"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Streaming API</h3>
<p>Streaming API provide server-sent events for post updates as well as site update</p>
<ul>
<li><code>GET /api/v1/stream/info?site=site-idd&amp;url=post-url&amp;since=unix_ts_msec</code> - returns stream (<code>event: info</code>) with <code>PostInfo</code> records for the site and url. <code>since</code> is optional</li>
<li><code>GET /api/v1/stream/last?site=site-id&amp;since=unix_ts_msec</code> - returns updates stream (<code>event: last</code>) with comments for the site, <code>since</code> is optional</li>
</ul>
<details><summary>response example</summary>
<pre><code>data: {"url":"https://radio-t.com/blah1","count":2,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.142872-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":3,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.157709-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":4,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.172991-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":5,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.188429-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":6,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.204742-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":7,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.220692-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":8,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.23817-05:00"}

event: info
data: {"url":"https://radio-t.com/blah1","count":9,"first_time":"2019-06-18T12:53:48.125686-05:00","last_time":"2019-06-18T12:53:48.254669-05:00"}
</code></pre>
</details>
<h3><a id="user-content-rss-feeds" class="anchor" aria-hidden="true" href="#rss-feeds"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>RSS feeds</h3>
<ul>
<li><code>GET /api/v1/rss/post?site=site-id&amp;url=post-url</code> - rss feed for a post</li>
<li><code>GET /api/v1/rss/site?site=site-id</code> - rss feed for given site</li>
<li><code>GET /api/v1/rss/reply?site=site-id&amp;user=user-id</code> - rss feed for replies to user's comments</li>
</ul>
<h3><a id="user-content-images-management" class="anchor" aria-hidden="true" href="#images-management"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Images management</h3>
<ul>
<li><code>GET /api/v1/picture/{user}/{id}</code> - load stored image</li>
<li><code>POST /api/v1/picture</code> - upload and store image, uses post form with <code>FormFile("file")</code>. returns <code>{"id": user/imgid}</code> <em>auth required</em></li>
</ul>
<p><em>returned id should be appended to load image url on caller side</em></p>
<h3><a id="user-content-email-subscription" class="anchor" aria-hidden="true" href="#email-subscription"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Email subscription</h3>
<ul>
<li>
<p><code>GET /api/v1/email?site=site-id</code> - get user's email, <em>auth required</em></p>
</li>
<li>
<p><code>POST /api/v1/email/subscribe?site=site-id&amp;address=user@example.org</code> -  makes confirmation token and sends it to user over email, <em>auth required</em></p>
<p>Trying to subscribe same email second time will return response code <code>409 Conflict</code> and explaining error message.</p>
</li>
<li>
<p><code>POST /api/v1/email/confirm?site=site-id&amp;tkn=token</code> - uses provided token parameter to set email for the user, <em>auth required</em></p>
<p>Setting email subscribe user for all first-level replies to his messages.</p>
</li>
<li>
<p><code>DELETE /api/v1/email?site=siteID</code> - removes user's email, <em>auth required</em></p>
</li>
</ul>
<h3><a id="user-content-admin" class="anchor" aria-hidden="true" href="#admin"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Admin</h3>
<ul>
<li><code>DELETE /api/v1/admin/comment/{id}?site=site-id&amp;url=post-url</code> - delete comment by <code>id</code>.</li>
<li><code>PUT /api/v1/admin/user/{userid}?site=site-id&amp;block=1&amp;ttl=7d</code> - block or unblock user with optional ttl (default=permanent)</li>
<li><code>GET api/v1/admin/blocked&amp;site=site-id</code> - list of blocked user ids
<div class="highlight highlight-source-go"><pre><span class="pl-k">type</span> <span class="pl-smi">BlockedUser</span> <span class="pl-k">struct</span> {
    <span class="pl-c1">ID</span>        <span class="pl-smi">string</span>    <span class="pl-s">`json:"id"`</span>
    <span class="pl-c1">Name</span>      <span class="pl-smi">string</span>    <span class="pl-s">`json:"name"`</span>
    <span class="pl-c1">Until</span>     time.<span class="pl-smi">Time</span> <span class="pl-s">`json:"time"`</span>
}</pre></div>
</li>
<li><code>GET /api/v1/admin/export?site=site-id&amp;mode=[stream|file]</code> - export all comments to json stream or gz file.</li>
<li><code>POST /api/v1/admin/import?site=site-id</code> - import comments from the backup, uses post body.</li>
<li><code>POST /api/v1/admin/import/form?site=site-id</code> - import comments from the backup, user post form.</li>
<li><code>POST /api/v1/admin/remap?site=site-id</code> - remap comments to different URLs. Expect list of "from-url new-url" pairs separated by \n.
From-url and new-url parts separated by space. If urls end with asterisk (*) it means matching by prefix. Remap procedure based on
export/import chain so make backup first.
<pre><code>http://oldsite.com* https://newsite.com*
http://oldsite.com/from-old-page/1 https://newsite.com/to-new-page/1
</code></pre>
</li>
<li><code>GET /api/v1/admin/wait?site=site-id</code> - wait for completion for any async migration ops (import or remap).</li>
<li><code>PUT /api/v1/admin/pin/{id}?site=site-id&amp;url=post-url&amp;pin=1</code> - pin or unpin comment.</li>
<li><code>GET /api/v1/admin/user/{userid}?site=site-id</code> - get user's info.</li>
<li><code>DELETE /api/v1/admin/user/{userid}?site=site-id</code> - delete all user's comments.</li>
<li><code>PUT /api/v1/admin/readonly?site=site-id&amp;url=post-url&amp;ro=1</code> - set read-only status</li>
<li><code>PUT /api/v1/admin/verify/{userid}?site=site-id&amp;verified=1</code> - set verified status</li>
<li><code>GET /api/v1/admin/deleteme?token=token</code> - process deleteme user's request</li>
</ul>
<p><em>all admin calls require auth and admin privilege</em></p>
<h2><a id="user-content-privacy" class="anchor" aria-hidden="true" href="#privacy"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Privacy</h2>
<ul>
<li>Remark42 is trying to be very sensitive to any private or semi-private information.</li>
<li>Authentication requesting the minimal possible scope from authentication providers. All extra information returned by them dropped immediately and not stored in any form.</li>
<li>Generally, remark42 keeps user id, username and avatar link only. None of these fields exposed directly - id and name hashed, avatar proxied.</li>
<li>There is no tracking of any sort.</li>
<li>Login mechanic uses JWT stored in a cookie (httpOnly, secured). The second cookie (XSRF_TOKEN) is a random id preventing CSRF.</li>
<li>There is no cross-site login, i.e., user's behavior can't be analyzed across independent sites running remark42.</li>
<li>There are no third-party analytic services involved.</li>
<li>User can request all information remark42 knows about and export to gz file.</li>
<li>Supported complete cleanup of all information related to user's activity.</li>
<li>Cookie lifespan can be restricted to session-only.</li>
<li>All potentially sensitive data stored by remark42 hashed and encrypted.</li>
</ul>
<h2><a id="user-content-technical-details" class="anchor" aria-hidden="true" href="#technical-details"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Technical details</h2>
<ul>
<li>Data stored in <a href="https://github.com/coreos/bbolt">boltdb</a> (embedded key/value database) files under <code>STORE_BOLT_PATH</code></li>
<li>Each site stored in a separate boltbd file.</li>
<li>In order to migrate/move remark42 to another host boltbd files as well as avatars directory <code>AVATAR_FS_PATH</code> should be transferred. Optionally, boltdb can be used to store avatars as well.</li>
<li>Automatic backup process runs every 24h and exports all content in json-like format to <code>backup-remark-YYYYMMDD.gz</code>.</li>
<li>Authentication implemented with <a href="https://github.com/go-pkgz/auth">go-pkgz/auth</a> stored in a cookie. It uses HttpOnly, secure cookies.</li>
<li>All heavy REST calls cached internally in LRU cache limited by <code>CACHE_MAX_ITEMS</code> and <code>CACHE_MAX_SIZE</code> with <a href="https://github.com/go-pkgz/rest">go-pkgz/rest</a></li>
<li>User's activity throttled globally (up to 1000 simultaneous requests) and limited locally (per user, usually up to 10 req/sec)</li>
<li>Request timeout set to 60sec</li>
<li>Admin authentication (<code>--admin-password</code> set) allows to hit remark42 API without social login and with admin privileges. Adds basic-auth for username: <code>admin</code>, password: <code>${ADMIN_PASSWD}</code>.</li>
<li>User can vote for the comment multiple times but only to change the vote. Double-voting not allowed.</li>
<li>User can edit comments in 5 mins (configurable) window after creation.</li>
<li>User ID hashed and prefixed by oauth provider name to avoid collisions and potential abuse.</li>
<li>All avatars resized and cached locally to prevent rate limiters from oauth providers, part of <a href="https://github.com/go-pkgz/auth">go-pkgz/auth</a> functionality.</li>
<li>Images can be proxied (<code>IMAGE_PROXY_HTTP2HTTPS=true</code>) to prevent mixed http/https.</li>
<li>All images can be proxied and saved (<code>IMAGE_PROXY_CACHE_EXTERNAL=true</code>) instead of serving from original location. Beware, images which are posted with this parameter enabled will be served from proxy even after it will be disabled.</li>
<li>Docker build uses <a href="https://github.com/umputun/baseimage">publicly available</a> base images.</li>
</ul>
</article></div>
</div></div></div></article><footer><div class="container"><div class="row"><div class="column">Total Projects: 1313</div><div class="column">Built On: 24 May 2020</div><div class="column">Version: 1.3.0</div></div></div></footer><script src="/selfhosted-awesome-unlist/site.js"></script></body></html>