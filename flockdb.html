<!DOCTYPE html><html><head><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="*  Twitter's distributed, fault-tolerant graph database."><meta name="DCTERMS.issued"><meta name="DCTERMS.modified"><title></title><link href="https://fonts.googleapis.com/css2?family=Special+Elite&amp;display=swap" rel="stylesheet"><link href="/selfhosted-awesome-unlist/site.css" rel="stylesheet" type="text/css"></head></head><body class="project"><nav class="navigation"><section class="container"><a class="navigation-title" href="/selfhosted-awesome-unlist/">Selfhosted Awesome [Un]list</a></section></nav><header><div class="container"><div class="row"><div class="column"><div class="title"><h1>flockdb</h1><span class="subheading">*  Twitter's distributed, fault-tolerant graph database.</span><div class="links"><a class="button button-outline" href="https://github.com/twitter/flockdb"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>FlockDB</a></div></div></div></div></div></header><section><div class="container"><div class="row"><div class="column"><div class="info statistics"><span class="stat pushed-at"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg>17 Mar 2017</span><span class="stat stargazers-count"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>3227</span><span class="stat issues"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>27</span></div></div></div><div class="row"><div class="column"><div class="info tags"><a class="tag" href="/selfhosted-awesome-unlist/languages/scala.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg>Scala</a><a class="tag" href="/selfhosted-awesome-unlist/tags/nosql.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">14</span>nosql</a><a class="tag" href="/selfhosted-awesome-unlist/tags/sysadmin.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">371</span>sysadmin</a></div></div></div></div></section><article><div class="container"><div class="row"><div class="column"><h1 id="status">STATUS</h1>
<p>Twitter is no longer maintaining this project or responding to issues or PRs.</p>
<h1 id="flockdb">FlockDB</h1>
<p>FlockDB is a distributed graph database for storing adjancency lists, with
goals of supporting:</p>
<ul>
<li>a high rate of add/update/remove operations</li>
<li>potientially complex set arithmetic queries</li>
<li>paging through query result sets containing millions of entries</li>
<li>ability to &quot;archive&quot; and later restore archived edges</li>
<li>horizontal scaling including replication</li>
<li>online data migration</li>
</ul>
<p>Non-goals include:</p>
<ul>
<li>multi-hop queries (or graph-walking queries)</li>
<li>automatic shard migrations</li>
</ul>
<p>FlockDB is much simpler than other graph databases such as neo4j because it
tries to solve fewer problems. It scales horizontally and is designed for
on-line, low-latency, high throughput environments such as web-sites.</p>
<p>Twitter uses FlockDB to store social graphs (who follows whom, who blocks
whom) and secondary indices. As of April 2010, the Twitter FlockDB cluster
stores 13+ billion edges and sustains peak traffic of 20k writes/second and
100k reads/second.</p>
<h1 id="it-does-what">It does what?</h1>
<p>If, for example, you&#39;re storing a social graph (user A follows user B), and
it&#39;s not necessarily symmetrical (A can follow B without B following A), then
FlockDB can store that relationship as an edge: node A points to node B. It
stores this edge with a sort position, and in both directions, so that it can
answer the question &quot;Who follows A?&quot; as well as &quot;Whom is A following?&quot;</p>
<p>This is called a directed graph. (Technically, FlockDB stores the adjacency
lists of a directed graph.) Each edge has a 64-bit source ID, a 64-bit
destination ID, a state (normal, removed, archived), and a 32-bit position
used for sorting. The edges are stored in both a forward and backward
direction, meaning that an edge can be queried based on either the source or
destination ID.</p>
<p>For example, if node 134 points to node 90, and its sort position is 5, then
there are two rows written into the backing store:</p>
<pre><code>forward: 134 -&gt; 90 at position 5
backward: 90 &lt;- 134 at position 5</code></pre><p>If you&#39;re storing a social graph, the graph might be called &quot;following&quot;, and
you might use the current time as the position, so that a listing of followers
is in recency order. In that case, if user 134 is Nick, and user 90 is Robey,
then FlockDB can store:</p>
<pre><code>forward: Nick follows Robey at 9:54 today
backward: Robey is followed by Nick at 9:54 today</code></pre><p>The (source, destination) must be unique: only one edge can point from node A
to node B, but the position and state may be modified at any time. Position is
used only for sorting the results of queries, and state is used to mark edges
that have been removed or archived (placed into cold sleep).</p>
<h1 id="building">Building</h1>
<p>In theory, building is as simple as</p>
<pre><code>$ sbt clean update package-dist</code></pre><p>but there are some pre-requisites. You need:</p>
<ul>
<li>java 1.6</li>
<li>sbt 0.7.4</li>
<li>thrift 0.5.0</li>
</ul>
<p>If you haven&#39;t used sbt before, this page has a quick setup:
<a href="http://code.google.com/p/simple-build-tool/wiki/Setup">http://code.google.com/p/simple-build-tool/wiki/Setup</a>.
My <code>~/bin/sbt</code> looks like this:</p>
<pre><code>#!/bin/bash
java -server -XX:+CMSClassUnloadingEnabled -XX:MaxPermSize=256m -Xmx1024m -jar `dirname $0`/sbt-launch-0.7.4.jar &quot;$@&quot;</code></pre><p>Apache Thrift 0.5.0 is pre-requisite for building java stubs of the thrift
IDL. It can&#39;t be installed via jar, so you&#39;ll need to install it separately
before you build. It can be found on the apache thrift site:
<a href="http://thrift.apache.org/">http://thrift.apache.org/</a>.
You can find the download for 0.5.0 here: 
<a href="http://archive.apache.org/dist/incubator/thrift/0.5.0-incubating/">http://archive.apache.org/dist/incubator/thrift/0.5.0-incubating/</a>.</p>
<p>In addition, the tests require a local mysql instance to be running, and for
<code>DB_USERNAME</code> and <code>DB_PASSWORD</code> env vars to contain login info for it. You can
skip the tests if you want (but you should feel a pang of guilt):</p>
<pre><code>$ NO_TESTS=1 sbt package-dist</code></pre><h1 id="running">Running</h1>
<p>Check out
<a href="http://github.com/twitter/flockdb/blob/master/doc/demo.markdown">the demo</a>
for instructions on how to start up a local development instance of FlockDB.
It also shows how to add edges, query them, etc.</p>
<h1 id="community">Community</h1>
<ul>
<li>Twitter: #flockdb</li>
<li>IRC: #twinfra on freenode (irc.freenode.net)</li>
<li>Mailing list: <a href="mailto:&#x66;&#108;&#x6f;&#99;&#107;&#100;&#x62;&#64;&#103;&#x6f;&#111;&#103;&#x6c;&#x65;&#103;&#114;&#111;&#117;&#x70;&#115;&#x2e;&#99;&#111;&#109;">&#x66;&#108;&#x6f;&#99;&#107;&#100;&#x62;&#64;&#103;&#x6f;&#111;&#103;&#x6c;&#x65;&#103;&#114;&#111;&#117;&#x70;&#115;&#x2e;&#99;&#111;&#109;</a> <a href="http://groups.google.com/group/flockdb">subscribe</a></li>
</ul>
<h1 id="contributors">Contributors</h1>
<ul>
<li>Nick Kallen @nk</li>
<li>Robey Pointer @robey</li>
<li>John Kalucki @jkalucki</li>
<li>Ed Ceaser @asdf</li>
</ul>
</div></div></div></article><footer><div class="container"><div class="row"><div class="column">Total Projects: 1313</div><div class="column">Built On: 03 May 2020</div><div class="column">Version: 1.1.0</div></div></div></footer><script src="/selfhosted-awesome-unlist/site.js"></script></body></html>