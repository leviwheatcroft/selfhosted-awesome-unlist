<!DOCTYPE html><html><head><head><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="description" content="Self-hosted Mailchimp alternative that you can easily integrate with your site. Helps you send and manage your application mailings. It support email marketing and conducting the daily stream of notifications you send to your users."><meta name="DCTERMS.issued"><meta name="DCTERMS.modified"><title></title><link href="https://fonts.googleapis.com/css2?family=Special+Elite&amp;display=swap" rel="stylesheet"><link href="/selfhosted-awesome-unlist/site.css" rel="stylesheet" type="text/css"></head></head><body class="project"><nav class="navigation"><section class="container"><a class="navigation-title" href="/selfhosted-awesome-unlist/">Selfhosted Awesome [Un]list</a></section></nav><header><div class="container"><div class="row"><div class="column"><div class="title"><h1>maily_herald</h1><span class="subheading">Self-hosted Mailchimp alternative that you can easily integrate with your site. Helps you send and manage your application mailings. It support email marketing and conducting the daily stream of notifications you send to your users.</span><div class="links"><a class="button button-outline" href="http://mailyherald.org/"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-external-link"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"></path><polyline points="15 3 21 3 21 9"></polyline><line x1="10" y1="14" x2="21" y2="3"></line></svg>MailyHerald</a><a class="button button-outline" href="https://github.com/Sology/maily_herald"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>Source Code</a></div></div></div></div></div></header><section><div class="container"><div class="row"><div class="column"><div class="info statistics"><span class="stat pushed-at"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg>29 Feb 2020</span><span class="stat stargazers-count"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-star"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>520</span><span class="stat issues"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-circle"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="12"></line><line x1="12" y1="16" x2="12.01" y2="16"></line></svg>25</span></div></div></div><div class="row"><div class="column"><div class="info tags"><a class="tag" href="/selfhosted-awesome-unlist/languages/undefined.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg></a><a class="tag" href="/selfhosted-awesome-unlist/languages/undefined.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg></a><a class="tag" href="/selfhosted-awesome-unlist/languages/undefined.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg></a><a class="tag" href="/selfhosted-awesome-unlist/languages/undefined.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-code"><polyline points="16 18 22 12 16 6"></polyline><polyline points="8 6 2 12 8 18"></polyline></svg></a><a class="tag" href="/selfhosted-awesome-unlist/tags/ruby.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">53</span>ruby</a><a class="tag" href="/selfhosted-awesome-unlist/tags/communication-systems.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">159</span>communication systems</a><a class="tag" href="/selfhosted-awesome-unlist/tags/selfhosted.html"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg><span class="count">943</span>selfhosted</a></div></div></div></div></section><article><div class="container"><div class="row"><div class="column">
<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content" itemprop="text"><p><a href="https://travis-ci.org/Sology/maily_herald" rel="nofollow"><img src="https://camo.githubusercontent.com/3d7343d1e5a0cf0b458067c7883cec0126d949a4/68747470733a2f2f7472617669732d63692e6f72672f536f6c6f67792f6d61696c795f686572616c642e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/Sology/maily_herald.svg?branch=master" style="max-width:100%;"></a></p>
<h1><a id="user-content-mailyherald" class="anchor" aria-hidden="true" href="#mailyherald"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MailyHerald</h1>
<p><a target="_blank" rel="noopener noreferrer" href="./doc/webui.png"><img src="./doc/webui.png" alt="MailyHerald with its Web UI" style="max-width:100%;"></a></p>
<p>MailyHerald is a Ruby on Rails gem that helps you send and manage your application mailings. Think of Maily as a self-hosted Mailchimp alternative you can easily integrate into your site. MailyHerald is great both for email marketing and conducting the daily stream of notifications you send to your users.</p>
<p>With MailyHerald you can send:</p>
<ul>
<li>ad-hoc mailings - arbitrary emails sent to one or more users at a given point in time (i.e. password reset instructions, special offers, announcements),</li>
<li>one-time mailings (i.e. account activation, welcome emails),</li>
<li>periodical mailings (i.e. weekly notifications, reminders),</li>
<li>mailing sequences - multiple ordered emails delivered with certain delays from a specific point in time (i.e. onboarding emails, site feature overview, reminders).</li>
</ul>
<p>Maily keeps track of user subscriptions and allows them to easily opt out. You can define who receives which emails and specify conditions that control delivery. All mailing deliveries are scheduled individually for each recipient, tracked and logged.</p>
<p>Maily seamlessly integrates with your app. It can use your regular Action Mailers or you can build email contents with <a href="http://liquidmarkup.org/" rel="nofollow">Liquid</a> markup templates.</p>
<p>Core Maily features are accessible for Rails programmers via the API. Apart from that, Maily has a nice Web UI provided by a separate <a href="https://github.com/Sology/maily_herald-webui">maily_herald-webui</a> gem.</p>
<h2><a id="user-content-requirements" class="anchor" aria-hidden="true" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h2>
<p>Both Ruby on Rails 3.2 and 4 are supported.</p>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>Simply just run</p>
<pre><code>gem install maily_herald
</code></pre>
<p>or put in your Gemfile</p>
<pre><code>gem "maily_herald"
</code></pre>
<h2><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Features</h2>
<ul>
<li>Designed for Ruby on Rails</li>
<li>Self-hosted</li>
<li>Seamless and flexible integration</li>
<li>Asynchronous email processing</li>
<li>Per-recipient delivery scheduling</li>
<li>Great both for developers (API) and end users (Web UI)</li>
<li>On-the-fly email templating using <a href="http://liquidmarkup.org/" rel="nofollow">Liquid</a> syntax</li>
<li>Four different mailing types</li>
<li>User-friendly subscription management i.e. via automatic &amp; personal opt-out links</li>
<li>Correspondence logging</li>
<li>Delivery conditions</li>
</ul>
<h2><a id="user-content-development-state" class="anchor" aria-hidden="true" href="#development-state"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Development state</h2>
<p>MailyHerald is a relatively young piece of software and it has been deployed in a few different production environments.</p>
<p>If you decide to use it, please tell us what you think about it. You can post some issues on GitHub or email us directly. We're waiting for your feedback.</p>
<p>Here are some things we would like to implement in the future:</p>
<ul>
<li>message analytics,</li>
<li>link tracking,</li>
<li>fetching bounces from email service (Amazon SES, Mandrill, Sendgrid etc.),</li>
<li>better templating,</li>
<li><em>put your beloved feature here</em>.</li>
</ul>
<h2><a id="user-content-how-it-works" class="anchor" aria-hidden="true" href="#how-it-works"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How it works</h2>
<p>There are a few key concepts that need to be explained in order to understand how Maily works. Some of them are similar to what you might know from other conventional email marketing software. Others come strictly from the Ruby on Rails world.</p>
<p><strong>Entities</strong></p>
<p>Entities are your mailing recipients. They will probably be represented in your application by <code>User</code> model.</p>
<p><strong>Mailings</strong></p>
<p>You usually send single emails to your users, one at a time. Mailing is a bunch of emails sent out to many users. MailyHerald allows you to send four types of Mailings: ad-hoc, one-times, periodicals and sequences.</p>
<p><strong>Contexts</strong></p>
<p>Maily Contexts provide a layer of abstraction for accessing collections of entities and their attributes.</p>
<p>There are three main things that Contexts do:</p>
<ul>
<li>They define sets of entities via standard Rails scopes (i.e. <code>User.activated</code> meaning all application users that activated their accounts).</li>
<li>They specify destination email addresses for entities (i.e. you can define that <code>User#email</code> method returns email address or specify a custom proc that does that).</li>
<li>They specify additional entity attributes that can be used inside Mailing templates, conditions etc. (essentially, any attribute accessible via Liquid).</li>
</ul>
<p><strong>Lists and Subscriptions</strong></p>
<p>Lists are sets of entities that receive certain mailings. Entities are added to Lists by creating Subscriptions. It is entirely up to you how you manage subscriptions in the application. Typically, you would put a checkbox in the user's profile page which subscribes and unsubscribes them from mailing lists.</p>
<p>Each Subscription has a unique token allowing users to be provided with one-click opt-out links.</p>
<p><strong>Mailers</strong></p>
<p>Mailers are the standard way of sending emails in Rails applications. MailyHerald hooks into ActionMailer internals and allows you to send Mailings just like you send your regular emails. All you need to do is inherit <code>MailyHerald::Mailer</code> in your Mailer.</p>
<p>There's also a possibility to send Mailings without using any of your custom Mailers. <code>MailyHerald::Mailer</code> is in this case used implicitly; email body and subject is stored directly in your Mailing definition as a Liquid template. Liquid gives you access to entity attributes defined in the Context. This way of creating Mailings is especially useful within the Web UI where you can build new Mailing by simply typing in its template.</p>
<p><strong>Delivery</strong></p>
<p>MailyHerald uses the great gem <a href="http://sidekiq.org/" rel="nofollow">Sidekiq</a> to process deliveries in the background. This applies to all kinds of Mailings - their deliveries are scheduled individually for each entity on the subscription list.</p>
<p>Maily checks periodically for scheduled mailings, and then the time comes, queues them for delivery. This is the job of MailyHerald Paperboy - a tiny daemon that runs in the background and checks the schedules. It is essential to make your mailings work.</p>
<h2><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2>
<p>Let's assume your entities are your <code>User</code> model objects. Read on in order to find out how to get started with Maily.</p>
<h3><a id="user-content-migrations" class="anchor" aria-hidden="true" href="#migrations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Migrations</h3>
<p>Install engine migrations and run them.</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">rake</span> <span class="pl-en">maily_herald</span>:install<span class="pl-pds">:migrations</span>
<span class="pl-en">rake</span> <span class="pl-pds">db</span>:<span class="pl-en">migrate</span></pre></div>
<h3><a id="user-content-defaults-optional" class="anchor" aria-hidden="true" href="#defaults-optional"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Defaults (optional)</h3>
<p>In some cases, you need to specify default <code>from</code> and <code>host</code> mailer options in your application in order to ensure proper email rendering:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/application.rb</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">action_mailer</span><span class="pl-kos">.</span><span class="pl-en">default_options</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">from</span>: <span class="pl-s">"hello@mailyherald.org"</span> <span class="pl-kos">}</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">action_mailer</span><span class="pl-kos">.</span><span class="pl-en">default_url_options</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">host</span>: <span class="pl-s">"mailyherald.org"</span> <span class="pl-kos">}</span></pre></div>
<h3><a id="user-content-initializer" class="anchor" aria-hidden="true" href="#initializer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initializer</h3>
<p>Generate an initializer:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">rails</span> <span class="pl-en">g</span> <span class="pl-en">maily_herald</span><span class="pl-pds">:install</span></pre></div>
<p>This will create the following file:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/initializers/maily_herald.rb</span>
<span class="pl-v">MailyHerald</span><span class="pl-kos">.</span><span class="pl-en">setup</span> <span class="pl-k">do</span> |<span class="pl-s1">config</span>|
  <span class="pl-c"># Put your contexts, mailing definitions etc. here.</span>
<span class="pl-k">end</span></pre></div>
<p>There are few things you need to put there.</p>
<p><strong>Set up your context</strong></p>
<p>Say, for example, you want to deliver your mailings to all your active users:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">context</span> <span class="pl-pds">:active_users</span> <span class="pl-k">do</span> |<span class="pl-s1">context</span>|
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">scope</span> <span class="pl-kos">{</span><span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">active</span><span class="pl-kos">}</span>
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">destination</span> <span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">email</span><span class="pl-kos">}</span>
  
  <span class="pl-c"># Alternatively, you can specify destination as attribute name:</span>
  <span class="pl-c"># context.destination = :email</span>
<span class="pl-k">end</span></pre></div>
<p><strong>Set up your lists</strong></p>
<p>The following means that all users in the <code>:active_users</code> context scope can be subscribed to the <code>:newsletters</code> list.</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-pds">:newsletters</span> <span class="pl-k">do</span> |<span class="pl-s1">list</span>|
  <span class="pl-s1">list</span><span class="pl-kos">.</span><span class="pl-en">context_name</span> <span class="pl-c1">=</span> <span class="pl-pds">:active_users</span>
<span class="pl-k">end</span></pre></div>
<p>MailyHerald lists are opt-in lists. They are empty by default, so make sure to add entities to them, i.e. by using <code>MailyHerald.subscribe</code> method.</p>
<p><strong>Set up your mailings</strong></p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">one_time_mailing</span> <span class="pl-pds">:hello</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">title</span> <span class="pl-c1">=</span> <span class="pl-s">"Hello mailing"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:notifications</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">mailer_name</span> <span class="pl-c1">=</span> <span class="pl-s">"UserMailer"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-v">Proc</span><span class="pl-kos">.</span><span class="pl-en">new</span><span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span> + <span class="pl-c1">1</span><span class="pl-kos">.</span><span class="pl-en">hour</span><span class="pl-kos">}</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span> <span class="pl-c"># mailings are disabled by default</span>
<span class="pl-k">end</span>

<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">periodical_mailing</span> <span class="pl-pds">:weekly_newsletter</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">title</span> <span class="pl-c1">=</span> <span class="pl-s">"Weekly newsletter"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:newsletters</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">mailer_name</span> <span class="pl-c1">=</span> <span class="pl-s">"UserMailer"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-v">Proc</span><span class="pl-kos">.</span><span class="pl-en">new</span><span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span> + <span class="pl-c1">1</span><span class="pl-kos">.</span><span class="pl-en">week</span><span class="pl-kos">}</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">period</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span><span class="pl-kos">.</span><span class="pl-en">week</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span>
<span class="pl-k">end</span></pre></div>
<p><strong>Configuration locking</strong></p>
<p>By default, all contexts, lists and mailings initialized inside <code>MailyHerald.setup</code> block are locked and cannot be edited at runtime. This constraint is enforced to maintain the nature of RoR application initializer files. Things set up in the initializer should always be read-only because the initializer is executed every time the application spawns.</p>
<p>If you need to set up mailings programmatically and make them unlocked, don't simply use <code>MailyHerald.setup</code>. Instead, use methods from the <code>MailyHerald</code> class directly. You can then enter your code, i.e. in a DB seed file or a rake task.</p>
<p>You would typically put your <code>MailyHerald.setup</code> block in the Maily initializer file. Keep in mind that this file is evaluated every time Rails boots up, so changes made there (i.e. new mailings added) will be reflected at next application launch.</p>
<h3><a id="user-content-different-mailing-types" class="anchor" aria-hidden="true" href="#different-mailing-types"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Different mailing types</h3>
<p><strong>AdHocMailing</strong> is the most similar to regular Ruby on Rails emails sent using ActionMailer. The only difference is that their delivery is handled by Maily and thus logged and optionally backgrounded.</p>
<p><strong>OneTimeMailing</strong> deliveries are performed only once to a single recipient at a scheduled delivery time. It is fully automatic and its delivery can't be manually triggered. OneTimeMailing schedules are created based on the <code>start_at</code> attribute individually for each recipient.</p>
<p><strong>PeriodicalMailing</strong> handles multiple, periodical email deliveries to individual recipients. It is also automatic. Apart from the <code>start_at</code> attribute, it also uses a <code>period</code> which defines the time distance between consecutive deliveries.</p>
<p><strong>Sequence</strong> allows you to send multiple different mailings to a given entity with various time delays. It is achieved by defining SequenceMailings associated to a Sequence with delivery delays stored in their <code>absolute_delay</code> attributes. A mailing delivery delay is calculated from a point in time defined in Sequence's <code>start_at</code> attribute (similar to PeriodicalMailing).</p>
<h3><a id="user-content-procs-and-liquid-syntax" class="anchor" aria-hidden="true" href="#procs-and-liquid-syntax"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Procs and Liquid syntax</h3>
<p>Mailing attributes such as <code>start_at</code> and <code>conditions</code> can be defined programmatically as procs or as a string using Liquid syntax. Here's an example of those two cases:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Using Proc:</span>
<span class="pl-en">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-v">Proc</span><span class="pl-kos">.</span><span class="pl-en">new</span><span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span> + <span class="pl-c1">5</span><span class="pl-kos">.</span><span class="pl-en">minutes</span><span class="pl-kos">}</span>

<span class="pl-c"># Using Liquid:</span>
<span class="pl-en">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-s">"user.created_at | plus: 5, 'minutes'"</span></pre></div>
<p>Liquid syntax is obviously more convenient for non-programmers (and can be safely used i.e. in WebUI) but requires some additional setup inside Maily Context. Context attributes available within Liquid templates have to be defined:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">context</span> <span class="pl-pds">:all_users</span> <span class="pl-k">do</span> |<span class="pl-s1">context</span>|
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">scope</span> <span class="pl-kos">{</span><span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">all</span><span class="pl-kos">}</span>
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">destination</span> <span class="pl-c1">=</span> <span class="pl-pds">:email</span>
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">attributes</span> <span class="pl-k">do</span> |<span class="pl-s1">user</span>| 
    <span class="pl-en">attribute_group</span>(<span class="pl-pds">:user</span><span class="pl-kos">)</span> <span class="pl-k">do</span>
      <span class="pl-en">attribute</span>(<span class="pl-pds">:name</span><span class="pl-kos">)</span> <span class="pl-kos">{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">name</span><span class="pl-kos">}</span>
      <span class="pl-en">attribute</span>(<span class="pl-pds">:email</span><span class="pl-kos">)</span> <span class="pl-kos">{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">email</span><span class="pl-kos">}</span>
      <span class="pl-en">attribute</span>(<span class="pl-pds">:created_at</span><span class="pl-kos">)</span> <span class="pl-kos">{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span><span class="pl-kos">}</span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<p>Maily provides some Liquid filters that are particularly useful for time manipulation:</p>
<ul>
<li><code>plus: &lt;number&gt;, '&lt;period&gt;'</code></li>
<li><code>minus: &lt;number&gt;, '&lt;period&gt;'</code></li>
</ul>
<p>They can be used for incrementing and decrementing the time value. <code>&lt;number&gt;</code> is simply an integer; <code>&lt;period&gt;</code> is one of 'minutes', 'hours', 'days' etc.</p>
<p>The Mailing body can also be defined programmatically using custom Mailer. The other way is to not define explicit Mailer but rather set the subject and template as Liquid templates.</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Using custom ActionMailer:</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">ad_hoc_mailing</span> <span class="pl-pds">:hello</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:all_users</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">mailer_name</span> <span class="pl-c1">=</span> <span class="pl-s">"UserMailer"</span> <span class="pl-c"># In this case, you should have a mailer called 'UserMailer' that defines method 'hello'.</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span>
<span class="pl-k">end</span>

<span class="pl-c"># Using Liquid templates:</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">ad_hoc_mailing</span> <span class="pl-pds">:hello</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:all_users</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">subject</span> <span class="pl-c1">=</span> <span class="pl-s">"Hello {{user.name}}!"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">template</span> <span class="pl-c1">=</span> <span class="pl-s">"What's up?"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span>
<span class="pl-k">end</span></pre></div>
<h3><a id="user-content-mailers" class="anchor" aria-hidden="true" href="#mailers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mailers</h3>
<p>If you want to use your custom ActionMailers with Maily, you need to modify them a bit.</p>
<p>First, each Mailer you want to use with MailyHerald needs to extend the <code>MailyHerald::Mailer</code> class.</p>
<p>Then each Mailer method must be named after the mailing identification name and accept only one parameter, which will be your entity (i.e. <code>User</code> class object).</p>
<p>This setup gives you additional instance variables available to you in your views:</p>
<ul>
<li><code>@maily_entity</code> - entity you are sending this email to,</li>
<li><code>@maily_mailing</code> - Mailing you are sending,</li>
<li><code>@maily_subscription</code> - <code>MailyHerald::Subscription</code> object related to this entity and Mailing,</li>
</ul>
<p>Here's the complete example:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-v">UserMailer</span> &lt; <span class="pl-v">MailyHerald</span>::<span class="pl-v">Mailer</span>
  <span class="pl-k">def</span> <span class="pl-en">hello</span> <span class="pl-s1">user</span>
    <span class="pl-en">mail</span> <span class="pl-pds">:subject</span> <span class="pl-c1">=&gt;</span> <span class="pl-s">"Hi there <span class="pl-s1"><span class="pl-kos">#{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">name</span><span class="pl-kos">}</span></span>!"</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<h3><a id="user-content-opt-outs" class="anchor" aria-hidden="true" href="#opt-outs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Opt-outs</h3>
<p>MailyHerald allows entities to easily opt-out using direct unsubscribe urls. Each entity subscription has its own token and based on this token, the opt-out URL is generated.</p>
<p>To process user opt-out requests, you need to mount Maily into your app:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/routes.rb</span>

<span class="pl-en">mount</span> <span class="pl-v">MailyHerald</span>::<span class="pl-v">Engine</span> <span class="pl-c1">=&gt;</span> <span class="pl-s">"/unsubscribe"</span><span class="pl-kos">,</span> <span class="pl-pds">:as</span> <span class="pl-c1">=&gt;</span> <span class="pl-s">"maily_herald_engine"</span></pre></div>
<p>Maily provides you with a URL helper that generates opt-out URLs (i.e. in your ActionMailer views):</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">maily_herald_engine</span><span class="pl-kos">.</span><span class="pl-en">maily_unsubscribe_url</span>(<span class="pl-c1">@maily_subscription</span><span class="pl-kos">)</span></pre></div>
<p>When you use Liquid for email templating, your context will always include the special attribute <code>subscription</code> that allows you to easily output unique opt-out URLs. Use the following syntax:</p>
<pre><code>{{subscription.token_url}}
</code></pre>
<p>Visiting an opt-out URL disables the subscription and by default redirects to "/".</p>
<h3><a id="user-content-delivery-and-background-processing" class="anchor" aria-hidden="true" href="#delivery-and-background-processing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Delivery and background processing</h3>
<p>Scheduled MailyHerald mailings are always sent in the background.</p>
<p>In order to make your deliveries work, you need to run MailyHerald Paperboy, which will take care of it:</p>
<pre><code>$ bundle exec maily_herald paperboy --start
</code></pre>
<p>Paperboy will monitor your mailing schedules and queue their delivery. The actual sending of emails is handled in the background as a Sidekiq job, so make sure you run Sidekiq alongside Paperboy.</p>
<p>You can't manually trigger delivery of one-time, periodical and sequence mailings. Their schedules and deliveries are maintained automatically.</p>
<p>Ad-hoc mailing, on the other hand, can (and should!) be manually scheduled for delivery:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-v">MailyHerald</span><span class="pl-kos">.</span><span class="pl-en">ad_hoc_mailing</span>(<span class="pl-pds">:password_reset</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">schedule_delivery_to</span> <span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">first</span><span class="pl-kos">,</span> <span class="pl-v">Time</span><span class="pl-kos">.</span><span class="pl-en">now</span></pre></div>
<p>Alernatively, for Action Mailer compatibility, you can use the standard syntax for sending emails:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-v">UserMailer</span><span class="pl-kos">.</span><span class="pl-en">password_reset</span>(<span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">first</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">deliver</span></pre></div>
<p>This code will process email delivery immediately, in the current thread, just like a regular Action Mailer.</p>
<h3><a id="user-content-thats-it" class="anchor" aria-hidden="true" href="#thats-it"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>That's it!</h3>
<p>Your Maily setup is now complete.</p>
<p>See <a href="http://www.rubydoc.info/gems/maily_herald" rel="nofollow">API Docs</a> for more details about usage and configuration.</p>
<h2><a id="user-content-configuring" class="anchor" aria-hidden="true" href="#configuring"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring</h2>
<p>You can configure your Maily using the config file <code>config/maily_herald.yml</code>. Supported options:</p>
<ul>
<li><code>verbose</code>: true,false</li>
<li><code>logfile</code>: where all the stuff is logged, usually 'log/maily_herald.log`</li>
<li><code>pidfile</code>: file name</li>
<li><code>redis_url</code>: string</li>
<li><code>redis_namespace</code>: string</li>
<li><code>redis_driver</code>: string</li>
</ul>
<h2><a id="user-content-other-stuff" class="anchor" aria-hidden="true" href="#other-stuff"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other stuff</h2>
<h3><a id="user-content-periodical-mailing-scheduling" class="anchor" aria-hidden="true" href="#periodical-mailing-scheduling"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Periodical mailing scheduling</h3>
<p>Periodical mailing is kind of a special one and has two modes of scheduling: general and individual. If you specify <code>start_at</code> as an absolute time, i.e. <code>"2111-01-01 11:11"</code>, it goes into general scheduling mode and consecutive mailings will be delivered to all subscribed entities at the same time at every period. This way you can send, for example, weekly newsletters every Monday to all subscribers.</p>
<p>When you specify <code>start_at</code> as an individual time, i.e. <code>"user.start_at"</code>, individual scheduling mode will be enabled. In this case, delivery periods will count individually for each user and deliveries will be made accordingly.</p>
<p>Individual scheduling mode is the only mode available for all other mailing types.</p>
<h3><a id="user-content-deployments" class="anchor" aria-hidden="true" href="#deployments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deployments</h3>
<p>Maily has a built-in simple support for Capistrano. It supports both v2 and v3 and automates the task of starting, stopping and restarting the Paperboy daemon during deployments.</p>
<p>To enable, just put the following line into your <code>Capfile</code>:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">require</span> <span class="pl-s">'maily_herald/capistrano'</span></pre></div>
<h3><a id="user-content-opt-out-urls" class="anchor" aria-hidden="true" href="#opt-out-urls"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Opt-out URLs</h3>
<p>By default, visiting an opt-out URL silently disables the subscription and redirects to "/". You can easily customize the redirect path by specifying <code>token_redirect</code> proc:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Evaluated within config:</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">token_redirect</span> <span class="pl-k">do</span> |<span class="pl-s1">controller</span><span class="pl-kos">,</span> <span class="pl-s1">subscription</span>|
  <span class="pl-c"># This is just an example, put here whatever you want.</span>
  <span class="pl-s1">controller</span><span class="pl-kos">.</span><span class="pl-en">view_context</span><span class="pl-kos">.</span><span class="pl-en">unsubscribed_path</span>
<span class="pl-k">end</span></pre></div>
<p>In case you need more customization, you can always overwrite <code>MailyHerald::TokensController</code> and its <code>get</code> method:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># app/controllers/maily_herald/tokens_controller.rb</span>
<span class="pl-k">module</span> <span class="pl-v">MailyHerald</span>
  <span class="pl-k">class</span> <span class="pl-v">TokensController</span> &lt; ::<span class="pl-v">ApplicationController</span>
    <span class="pl-en">before_action</span> <span class="pl-pds">:find_subscription</span>

    <span class="pl-k">def</span> <span class="pl-en">get</span>
      <span class="pl-k">if</span> <span class="pl-c1">@subscription</span> &amp;&amp; <span class="pl-c1">@subscription</span><span class="pl-kos">.</span><span class="pl-en">active?</span>
        <span class="pl-c1">@subscription</span><span class="pl-kos">.</span><span class="pl-en">deactivate!</span>
        <span class="pl-c"># now render some custom view</span>
      <span class="pl-k">else</span>
        <span class="pl-en">redirect_to</span>(<span class="pl-en">main_app</span><span class="pl-kos">.</span><span class="pl-en">root_url</span><span class="pl-kos">)</span>
      <span class="pl-k">end</span>
    <span class="pl-k">end</span>

    <span class="pl-k">private</span>

    <span class="pl-k">def</span> <span class="pl-en">find_subscription</span>
      <span class="pl-c1">@subscription</span> ||= <span class="pl-v">MailyHerald</span>::<span class="pl-v">Subscription</span><span class="pl-kos">.</span><span class="pl-en">find_by_token</span>(<span class="pl-en">params</span><span class="pl-kos">[</span><span class="pl-pds">:token</span><span class="pl-kos">]</span><span class="pl-kos">)</span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<h3><a id="user-content-redis-namespaces" class="anchor" aria-hidden="true" href="#redis-namespaces"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redis namespaces</h3>
<p>If you want to use MailyHerald with non-standard Redis namespace, make sure your Sidekiq is also configured properly. This usually involves creating an initializer file:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/initializers/sidekiq.rb</span>
<span class="pl-v">Sidekiq</span><span class="pl-kos">.</span><span class="pl-en">configure_server</span> <span class="pl-k">do</span> |<span class="pl-s1">config</span>|
  <span class="pl-s1">config</span><span class="pl-kos">.</span><span class="pl-en">redis</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">namespace</span>: <span class="pl-s">'maily'</span> <span class="pl-kos">}</span>
<span class="pl-k">end</span>
<span class="pl-v">Sidekiq</span><span class="pl-kos">.</span><span class="pl-en">configure_client</span> <span class="pl-k">do</span> |<span class="pl-s1">config</span>|
  <span class="pl-s1">config</span><span class="pl-kos">.</span><span class="pl-en">redis</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">namespace</span>: <span class="pl-s">'maily'</span> <span class="pl-kos">}</span>
<span class="pl-k">end</span></pre></div>
<p>Then make sure you tell Maily about the change:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-c"><span class="pl-c">#</span> config/maily_herald.yml</span>
---
<span class="pl-ent">:redis_namespace</span>: <span class="pl-s">maily</span></pre></div>
<h2><a id="user-content-contributing" class="anchor" aria-hidden="true" href="#contributing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contributing</h2>
<p>Please aim your pull requests to 'development' branch.</p>
<p>Your changes should be well tested. To set up test environment just run:</p>
<pre><code>RAILS_ENV=test rake db:setup
rspec
guard # execute specs interactively
</code></pre>
<h2><a id="user-content-more-information" class="anchor" aria-hidden="true" href="#more-information"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>More Information</h2>
<ul>
<li><a href="http://mailyherald.org" rel="nofollow">Home Page</a></li>
<li><a href="http://www.rubydoc.info/gems/maily_herald" rel="nofollow">API Docs</a></li>
<li><a href="http://showcase.sology.eu/maily_herald" rel="nofollow">Showcase</a></li>
<li><a href="https://github.com/Sology/maily_testapp">Sample application</a></li>
</ul>
<p>Although we work hard on MailyHerald development, we can't guarantee it is free of bugs. If you find one, please make sure to report it using <a href="https://github.com/Sology/maily_herald/issues">issues tracker on Github</a>. You can also post your feature requests there too.</p>
<h2><a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>License</h2>
<p>LGPLv3 License. Copyright 2013-2015 Sology. <a href="http://www.sology.eu" rel="nofollow">http://www.sology.eu</a></p>
<p>Initial development sponsored by Smart Language Apps Limited <a href="http://smartlanguageapps.com/" rel="nofollow">http://smartlanguageapps.com/</a></p>
</article></div>
<div id="readme" class="md" data-path="README.md"><article class="markdown-body entry-content container-lg" itemprop="text"><p><a href="https://travis-ci.org/Sology/maily_herald" rel="nofollow"><img src="https://camo.githubusercontent.com/3d7343d1e5a0cf0b458067c7883cec0126d949a4/68747470733a2f2f7472617669732d63692e6f72672f536f6c6f67792f6d61696c795f686572616c642e7376673f6272616e63683d6d6173746572" alt="Build Status" data-canonical-src="https://travis-ci.org/Sology/maily_herald.svg?branch=master" style="max-width:100%;"></a></p>
<h1><a id="user-content-mailyherald" class="anchor" aria-hidden="true" href="#mailyherald"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>MailyHerald</h1>
<p><a target="_blank" rel="noopener noreferrer" href="./doc/webui.png"><img src="./doc/webui.png" alt="MailyHerald with its Web UI" style="max-width:100%;"></a></p>
<p>MailyHerald is a Ruby on Rails gem that helps you send and manage your application mailings. Think of Maily as a self-hosted Mailchimp alternative you can easily integrate into your site. MailyHerald is great both for email marketing and conducting the daily stream of notifications you send to your users.</p>
<p>With MailyHerald you can send:</p>
<ul>
<li>ad-hoc mailings - arbitrary emails sent to one or more users at a given point in time (i.e. password reset instructions, special offers, announcements),</li>
<li>one-time mailings (i.e. account activation, welcome emails),</li>
<li>periodical mailings (i.e. weekly notifications, reminders),</li>
<li>mailing sequences - multiple ordered emails delivered with certain delays from a specific point in time (i.e. onboarding emails, site feature overview, reminders).</li>
</ul>
<p>Maily keeps track of user subscriptions and allows them to easily opt out. You can define who receives which emails and specify conditions that control delivery. All mailing deliveries are scheduled individually for each recipient, tracked and logged.</p>
<p>Maily seamlessly integrates with your app. It can use your regular Action Mailers or you can build email contents with <a href="http://liquidmarkup.org/" rel="nofollow">Liquid</a> markup templates.</p>
<p>Core Maily features are accessible for Rails programmers via the API. Apart from that, Maily has a nice Web UI provided by a separate <a href="https://github.com/Sology/maily_herald-webui">maily_herald-webui</a> gem.</p>
<h2><a id="user-content-requirements" class="anchor" aria-hidden="true" href="#requirements"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h2>
<p>Both Ruby on Rails 3.2 and 4 are supported.</p>
<h2><a id="user-content-installation" class="anchor" aria-hidden="true" href="#installation"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Installation</h2>
<p>Simply just run</p>
<pre><code>gem install maily_herald
</code></pre>
<p>or put in your Gemfile</p>
<pre><code>gem "maily_herald"
</code></pre>
<h2><a id="user-content-features" class="anchor" aria-hidden="true" href="#features"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Features</h2>
<ul>
<li>Designed for Ruby on Rails</li>
<li>Self-hosted</li>
<li>Seamless and flexible integration</li>
<li>Asynchronous email processing</li>
<li>Per-recipient delivery scheduling</li>
<li>Great both for developers (API) and end users (Web UI)</li>
<li>On-the-fly email templating using <a href="http://liquidmarkup.org/" rel="nofollow">Liquid</a> syntax</li>
<li>Four different mailing types</li>
<li>User-friendly subscription management i.e. via automatic &amp; personal opt-out links</li>
<li>Correspondence logging</li>
<li>Delivery conditions</li>
</ul>
<h2><a id="user-content-development-state" class="anchor" aria-hidden="true" href="#development-state"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Development state</h2>
<p>MailyHerald is a relatively young piece of software and it has been deployed in a few different production environments.</p>
<p>If you decide to use it, please tell us what you think about it. You can post some issues on GitHub or email us directly. We're waiting for your feedback.</p>
<p>Here are some things we would like to implement in the future:</p>
<ul>
<li>message analytics,</li>
<li>link tracking,</li>
<li>fetching bounces from email service (Amazon SES, Mandrill, Sendgrid etc.),</li>
<li>better templating,</li>
<li><em>put your beloved feature here</em>.</li>
</ul>
<h2><a id="user-content-how-it-works" class="anchor" aria-hidden="true" href="#how-it-works"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>How it works</h2>
<p>There are a few key concepts that need to be explained in order to understand how Maily works. Some of them are similar to what you might know from other conventional email marketing software. Others come strictly from the Ruby on Rails world.</p>
<p><strong>Entities</strong></p>
<p>Entities are your mailing recipients. They will probably be represented in your application by <code>User</code> model.</p>
<p><strong>Mailings</strong></p>
<p>You usually send single emails to your users, one at a time. Mailing is a bunch of emails sent out to many users. MailyHerald allows you to send four types of Mailings: ad-hoc, one-times, periodicals and sequences.</p>
<p><strong>Contexts</strong></p>
<p>Maily Contexts provide a layer of abstraction for accessing collections of entities and their attributes.</p>
<p>There are three main things that Contexts do:</p>
<ul>
<li>They define sets of entities via standard Rails scopes (i.e. <code>User.activated</code> meaning all application users that activated their accounts).</li>
<li>They specify destination email addresses for entities (i.e. you can define that <code>User#email</code> method returns email address or specify a custom proc that does that).</li>
<li>They specify additional entity attributes that can be used inside Mailing templates, conditions etc. (essentially, any attribute accessible via Liquid).</li>
</ul>
<p><strong>Lists and Subscriptions</strong></p>
<p>Lists are sets of entities that receive certain mailings. Entities are added to Lists by creating Subscriptions. It is entirely up to you how you manage subscriptions in the application. Typically, you would put a checkbox in the user's profile page which subscribes and unsubscribes them from mailing lists.</p>
<p>Each Subscription has a unique token allowing users to be provided with one-click opt-out links.</p>
<p><strong>Mailers</strong></p>
<p>Mailers are the standard way of sending emails in Rails applications. MailyHerald hooks into ActionMailer internals and allows you to send Mailings just like you send your regular emails. All you need to do is inherit <code>MailyHerald::Mailer</code> in your Mailer.</p>
<p>There's also a possibility to send Mailings without using any of your custom Mailers. <code>MailyHerald::Mailer</code> is in this case used implicitly; email body and subject is stored directly in your Mailing definition as a Liquid template. Liquid gives you access to entity attributes defined in the Context. This way of creating Mailings is especially useful within the Web UI where you can build new Mailing by simply typing in its template.</p>
<p><strong>Delivery</strong></p>
<p>MailyHerald uses the great gem <a href="http://sidekiq.org/" rel="nofollow">Sidekiq</a> to process deliveries in the background. This applies to all kinds of Mailings - their deliveries are scheduled individually for each entity on the subscription list.</p>
<p>Maily checks periodically for scheduled mailings, and then the time comes, queues them for delivery. This is the job of MailyHerald Paperboy - a tiny daemon that runs in the background and checks the schedules. It is essential to make your mailings work.</p>
<h2><a id="user-content-usage" class="anchor" aria-hidden="true" href="#usage"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Usage</h2>
<p>Let's assume your entities are your <code>User</code> model objects. Read on in order to find out how to get started with Maily.</p>
<h3><a id="user-content-migrations" class="anchor" aria-hidden="true" href="#migrations"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Migrations</h3>
<p>Install engine migrations and run them.</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">rake</span> <span class="pl-en">maily_herald</span>:install<span class="pl-pds">:migrations</span>
<span class="pl-en">rake</span> <span class="pl-pds">db</span>:<span class="pl-en">migrate</span></pre></div>
<h3><a id="user-content-defaults-optional" class="anchor" aria-hidden="true" href="#defaults-optional"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Defaults (optional)</h3>
<p>In some cases, you need to specify default <code>from</code> and <code>host</code> mailer options in your application in order to ensure proper email rendering:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/application.rb</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">action_mailer</span><span class="pl-kos">.</span><span class="pl-en">default_options</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">from</span>: <span class="pl-s">"hello@mailyherald.org"</span> <span class="pl-kos">}</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">action_mailer</span><span class="pl-kos">.</span><span class="pl-en">default_url_options</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">host</span>: <span class="pl-s">"mailyherald.org"</span> <span class="pl-kos">}</span></pre></div>
<h3><a id="user-content-initializer" class="anchor" aria-hidden="true" href="#initializer"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Initializer</h3>
<p>Generate an initializer:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">rails</span> <span class="pl-en">g</span> <span class="pl-en">maily_herald</span><span class="pl-pds">:install</span></pre></div>
<p>This will create the following file:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/initializers/maily_herald.rb</span>
<span class="pl-v">MailyHerald</span><span class="pl-kos">.</span><span class="pl-en">setup</span> <span class="pl-k">do</span> |<span class="pl-s1">config</span>|
  <span class="pl-c"># Put your contexts, mailing definitions etc. here.</span>
<span class="pl-k">end</span></pre></div>
<p>There are few things you need to put there.</p>
<p><strong>Set up your context</strong></p>
<p>Say, for example, you want to deliver your mailings to all your active users:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">context</span> <span class="pl-pds">:active_users</span> <span class="pl-k">do</span> |<span class="pl-s1">context</span>|
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">scope</span> <span class="pl-kos">{</span><span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">active</span><span class="pl-kos">}</span>
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">destination</span> <span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">email</span><span class="pl-kos">}</span>
  
  <span class="pl-c"># Alternatively, you can specify destination as attribute name:</span>
  <span class="pl-c"># context.destination = :email</span>
<span class="pl-k">end</span></pre></div>
<p><strong>Set up your lists</strong></p>
<p>The following means that all users in the <code>:active_users</code> context scope can be subscribed to the <code>:newsletters</code> list.</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-pds">:newsletters</span> <span class="pl-k">do</span> |<span class="pl-s1">list</span>|
  <span class="pl-s1">list</span><span class="pl-kos">.</span><span class="pl-en">context_name</span> <span class="pl-c1">=</span> <span class="pl-pds">:active_users</span>
<span class="pl-k">end</span></pre></div>
<p>MailyHerald lists are opt-in lists. They are empty by default, so make sure to add entities to them, i.e. by using <code>MailyHerald.subscribe</code> method.</p>
<p><strong>Set up your mailings</strong></p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">one_time_mailing</span> <span class="pl-pds">:hello</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">title</span> <span class="pl-c1">=</span> <span class="pl-s">"Hello mailing"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:notifications</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">mailer_name</span> <span class="pl-c1">=</span> <span class="pl-s">"UserMailer"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-v">Proc</span><span class="pl-kos">.</span><span class="pl-en">new</span><span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span> + <span class="pl-c1">1</span><span class="pl-kos">.</span><span class="pl-en">hour</span><span class="pl-kos">}</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span> <span class="pl-c"># mailings are disabled by default</span>
<span class="pl-k">end</span>

<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">periodical_mailing</span> <span class="pl-pds">:weekly_newsletter</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">title</span> <span class="pl-c1">=</span> <span class="pl-s">"Weekly newsletter"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:newsletters</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">mailer_name</span> <span class="pl-c1">=</span> <span class="pl-s">"UserMailer"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-v">Proc</span><span class="pl-kos">.</span><span class="pl-en">new</span><span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span> + <span class="pl-c1">1</span><span class="pl-kos">.</span><span class="pl-en">week</span><span class="pl-kos">}</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">period</span> <span class="pl-c1">=</span> <span class="pl-c1">1</span><span class="pl-kos">.</span><span class="pl-en">week</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span>
<span class="pl-k">end</span></pre></div>
<p><strong>Configuration locking</strong></p>
<p>By default, all contexts, lists and mailings initialized inside <code>MailyHerald.setup</code> block are locked and cannot be edited at runtime. This constraint is enforced to maintain the nature of RoR application initializer files. Things set up in the initializer should always be read-only because the initializer is executed every time the application spawns.</p>
<p>If you need to set up mailings programmatically and make them unlocked, don't simply use <code>MailyHerald.setup</code>. Instead, use methods from the <code>MailyHerald</code> class directly. You can then enter your code, i.e. in a DB seed file or a rake task.</p>
<p>You would typically put your <code>MailyHerald.setup</code> block in the Maily initializer file. Keep in mind that this file is evaluated every time Rails boots up, so changes made there (i.e. new mailings added) will be reflected at next application launch.</p>
<h3><a id="user-content-different-mailing-types" class="anchor" aria-hidden="true" href="#different-mailing-types"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Different mailing types</h3>
<p><strong>AdHocMailing</strong> is the most similar to regular Ruby on Rails emails sent using ActionMailer. The only difference is that their delivery is handled by Maily and thus logged and optionally backgrounded.</p>
<p><strong>OneTimeMailing</strong> deliveries are performed only once to a single recipient at a scheduled delivery time. It is fully automatic and its delivery can't be manually triggered. OneTimeMailing schedules are created based on the <code>start_at</code> attribute individually for each recipient.</p>
<p><strong>PeriodicalMailing</strong> handles multiple, periodical email deliveries to individual recipients. It is also automatic. Apart from the <code>start_at</code> attribute, it also uses a <code>period</code> which defines the time distance between consecutive deliveries.</p>
<p><strong>Sequence</strong> allows you to send multiple different mailings to a given entity with various time delays. It is achieved by defining SequenceMailings associated to a Sequence with delivery delays stored in their <code>absolute_delay</code> attributes. A mailing delivery delay is calculated from a point in time defined in Sequence's <code>start_at</code> attribute (similar to PeriodicalMailing).</p>
<h3><a id="user-content-procs-and-liquid-syntax" class="anchor" aria-hidden="true" href="#procs-and-liquid-syntax"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Procs and Liquid syntax</h3>
<p>Mailing attributes such as <code>start_at</code> and <code>conditions</code> can be defined programmatically as procs or as a string using Liquid syntax. Here's an example of those two cases:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Using Proc:</span>
<span class="pl-en">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-v">Proc</span><span class="pl-kos">.</span><span class="pl-en">new</span><span class="pl-kos">{</span>|<span class="pl-s1">user</span>| <span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span> + <span class="pl-c1">5</span><span class="pl-kos">.</span><span class="pl-en">minutes</span><span class="pl-kos">}</span>

<span class="pl-c"># Using Liquid:</span>
<span class="pl-en">mailing</span><span class="pl-kos">.</span><span class="pl-en">start_at</span> <span class="pl-c1">=</span> <span class="pl-s">"user.created_at | plus: 5, 'minutes'"</span></pre></div>
<p>Liquid syntax is obviously more convenient for non-programmers (and can be safely used i.e. in WebUI) but requires some additional setup inside Maily Context. Context attributes available within Liquid templates have to be defined:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">context</span> <span class="pl-pds">:all_users</span> <span class="pl-k">do</span> |<span class="pl-s1">context</span>|
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">scope</span> <span class="pl-kos">{</span><span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">all</span><span class="pl-kos">}</span>
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">destination</span> <span class="pl-c1">=</span> <span class="pl-pds">:email</span>
  <span class="pl-s1">context</span><span class="pl-kos">.</span><span class="pl-en">attributes</span> <span class="pl-k">do</span> |<span class="pl-s1">user</span>| 
    <span class="pl-en">attribute_group</span><span class="pl-kos">(</span><span class="pl-pds">:user</span><span class="pl-kos">)</span> <span class="pl-k">do</span>
      <span class="pl-en">attribute</span><span class="pl-kos">(</span><span class="pl-pds">:name</span><span class="pl-kos">)</span> <span class="pl-kos">{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">name</span><span class="pl-kos">}</span>
      <span class="pl-en">attribute</span><span class="pl-kos">(</span><span class="pl-pds">:email</span><span class="pl-kos">)</span> <span class="pl-kos">{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">email</span><span class="pl-kos">}</span>
      <span class="pl-en">attribute</span><span class="pl-kos">(</span><span class="pl-pds">:created_at</span><span class="pl-kos">)</span> <span class="pl-kos">{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">created_at</span><span class="pl-kos">}</span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<p>Maily provides some Liquid filters that are particularly useful for time manipulation:</p>
<ul>
<li><code>plus: &lt;number&gt;, '&lt;period&gt;'</code></li>
<li><code>minus: &lt;number&gt;, '&lt;period&gt;'</code></li>
</ul>
<p>They can be used for incrementing and decrementing the time value. <code>&lt;number&gt;</code> is simply an integer; <code>&lt;period&gt;</code> is one of 'minutes', 'hours', 'days' etc.</p>
<p>The Mailing body can also be defined programmatically using custom Mailer. The other way is to not define explicit Mailer but rather set the subject and template as Liquid templates.</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Using custom ActionMailer:</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">ad_hoc_mailing</span> <span class="pl-pds">:hello</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:all_users</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">mailer_name</span> <span class="pl-c1">=</span> <span class="pl-s">"UserMailer"</span> <span class="pl-c"># In this case, you should have a mailer called 'UserMailer' that defines method 'hello'.</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span>
<span class="pl-k">end</span>

<span class="pl-c"># Using Liquid templates:</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">ad_hoc_mailing</span> <span class="pl-pds">:hello</span> <span class="pl-k">do</span> |<span class="pl-s1">mailing</span>|
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">list</span> <span class="pl-c1">=</span> <span class="pl-pds">:all_users</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">subject</span> <span class="pl-c1">=</span> <span class="pl-s">"Hello {{user.name}}!"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">template</span> <span class="pl-c1">=</span> <span class="pl-s">"What's up?"</span>
  <span class="pl-s1">mailing</span><span class="pl-kos">.</span><span class="pl-en">enable</span>
<span class="pl-k">end</span></pre></div>
<h3><a id="user-content-mailers" class="anchor" aria-hidden="true" href="#mailers"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Mailers</h3>
<p>If you want to use your custom ActionMailers with Maily, you need to modify them a bit.</p>
<p>First, each Mailer you want to use with MailyHerald needs to extend the <code>MailyHerald::Mailer</code> class.</p>
<p>Then each Mailer method must be named after the mailing identification name and accept only one parameter, which will be your entity (i.e. <code>User</code> class object).</p>
<p>This setup gives you additional instance variables available to you in your views:</p>
<ul>
<li><code>@maily_entity</code> - entity you are sending this email to,</li>
<li><code>@maily_mailing</code> - Mailing you are sending,</li>
<li><code>@maily_subscription</code> - <code>MailyHerald::Subscription</code> object related to this entity and Mailing,</li>
</ul>
<p>Here's the complete example:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-k">class</span> <span class="pl-v">UserMailer</span> &lt; <span class="pl-v">MailyHerald</span>::<span class="pl-v">Mailer</span>
  <span class="pl-k">def</span> <span class="pl-en">hello</span> <span class="pl-s1">user</span>
    <span class="pl-en">mail</span> <span class="pl-pds">:subject</span> <span class="pl-c1">=&gt;</span> <span class="pl-s">"Hi there <span class="pl-s1"><span class="pl-kos">#{</span><span class="pl-s1">user</span><span class="pl-kos">.</span><span class="pl-en">name</span><span class="pl-kos">}</span></span>!"</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<h3><a id="user-content-opt-outs" class="anchor" aria-hidden="true" href="#opt-outs"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Opt-outs</h3>
<p>MailyHerald allows entities to easily opt-out using direct unsubscribe urls. Each entity subscription has its own token and based on this token, the opt-out URL is generated.</p>
<p>To process user opt-out requests, you need to mount Maily into your app:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/routes.rb</span>

<span class="pl-en">mount</span> <span class="pl-v">MailyHerald</span>::<span class="pl-v">Engine</span> <span class="pl-c1">=&gt;</span> <span class="pl-s">"/unsubscribe"</span><span class="pl-kos">,</span> <span class="pl-pds">:as</span> <span class="pl-c1">=&gt;</span> <span class="pl-s">"maily_herald_engine"</span></pre></div>
<p>Maily provides you with a URL helper that generates opt-out URLs (i.e. in your ActionMailer views):</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">maily_herald_engine</span><span class="pl-kos">.</span><span class="pl-en">maily_unsubscribe_url</span><span class="pl-kos">(</span><span class="pl-c1">@maily_subscription</span><span class="pl-kos">)</span></pre></div>
<p>When you use Liquid for email templating, your context will always include the special attribute <code>subscription</code> that allows you to easily output unique opt-out URLs. Use the following syntax:</p>
<pre><code>{{subscription.token_url}}
</code></pre>
<p>Visiting an opt-out URL disables the subscription and by default redirects to "/".</p>
<h3><a id="user-content-delivery-and-background-processing" class="anchor" aria-hidden="true" href="#delivery-and-background-processing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Delivery and background processing</h3>
<p>Scheduled MailyHerald mailings are always sent in the background.</p>
<p>In order to make your deliveries work, you need to run MailyHerald Paperboy, which will take care of it:</p>
<pre><code>$ bundle exec maily_herald paperboy --start
</code></pre>
<p>Paperboy will monitor your mailing schedules and queue their delivery. The actual sending of emails is handled in the background as a Sidekiq job, so make sure you run Sidekiq alongside Paperboy.</p>
<p>You can't manually trigger delivery of one-time, periodical and sequence mailings. Their schedules and deliveries are maintained automatically.</p>
<p>Ad-hoc mailing, on the other hand, can (and should!) be manually scheduled for delivery:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-v">MailyHerald</span><span class="pl-kos">.</span><span class="pl-en">ad_hoc_mailing</span><span class="pl-kos">(</span><span class="pl-pds">:password_reset</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">schedule_delivery_to</span> <span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">first</span><span class="pl-kos">,</span> <span class="pl-v">Time</span><span class="pl-kos">.</span><span class="pl-en">now</span></pre></div>
<p>Alernatively, for Action Mailer compatibility, you can use the standard syntax for sending emails:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-v">UserMailer</span><span class="pl-kos">.</span><span class="pl-en">password_reset</span><span class="pl-kos">(</span><span class="pl-v">User</span><span class="pl-kos">.</span><span class="pl-en">first</span><span class="pl-kos">)</span><span class="pl-kos">.</span><span class="pl-en">deliver</span></pre></div>
<p>This code will process email delivery immediately, in the current thread, just like a regular Action Mailer.</p>
<h3><a id="user-content-thats-it" class="anchor" aria-hidden="true" href="#thats-it"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>That's it!</h3>
<p>Your Maily setup is now complete.</p>
<p>See <a href="http://www.rubydoc.info/gems/maily_herald" rel="nofollow">API Docs</a> for more details about usage and configuration.</p>
<h2><a id="user-content-configuring" class="anchor" aria-hidden="true" href="#configuring"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Configuring</h2>
<p>You can configure your Maily using the config file <code>config/maily_herald.yml</code>. Supported options:</p>
<ul>
<li><code>verbose</code>: true,false</li>
<li><code>logfile</code>: where all the stuff is logged, usually 'log/maily_herald.log`</li>
<li><code>pidfile</code>: file name</li>
<li><code>redis_url</code>: string</li>
<li><code>redis_namespace</code>: string</li>
<li><code>redis_driver</code>: string</li>
</ul>
<h2><a id="user-content-other-stuff" class="anchor" aria-hidden="true" href="#other-stuff"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Other stuff</h2>
<h3><a id="user-content-periodical-mailing-scheduling" class="anchor" aria-hidden="true" href="#periodical-mailing-scheduling"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Periodical mailing scheduling</h3>
<p>Periodical mailing is kind of a special one and has two modes of scheduling: general and individual. If you specify <code>start_at</code> as an absolute time, i.e. <code>"2111-01-01 11:11"</code>, it goes into general scheduling mode and consecutive mailings will be delivered to all subscribed entities at the same time at every period. This way you can send, for example, weekly newsletters every Monday to all subscribers.</p>
<p>When you specify <code>start_at</code> as an individual time, i.e. <code>"user.start_at"</code>, individual scheduling mode will be enabled. In this case, delivery periods will count individually for each user and deliveries will be made accordingly.</p>
<p>Individual scheduling mode is the only mode available for all other mailing types.</p>
<h3><a id="user-content-deployments" class="anchor" aria-hidden="true" href="#deployments"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Deployments</h3>
<p>Maily has a built-in simple support for Capistrano. It supports both v2 and v3 and automates the task of starting, stopping and restarting the Paperboy daemon during deployments.</p>
<p>To enable, just put the following line into your <code>Capfile</code>:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-en">require</span> <span class="pl-s">'maily_herald/capistrano'</span></pre></div>
<h3><a id="user-content-opt-out-urls" class="anchor" aria-hidden="true" href="#opt-out-urls"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Opt-out URLs</h3>
<p>By default, visiting an opt-out URL silently disables the subscription and redirects to "/". You can easily customize the redirect path by specifying <code>token_redirect</code> proc:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># Evaluated within config:</span>
<span class="pl-en">config</span><span class="pl-kos">.</span><span class="pl-en">token_redirect</span> <span class="pl-k">do</span> |<span class="pl-s1">controller</span><span class="pl-kos">,</span> <span class="pl-s1">subscription</span>|
  <span class="pl-c"># This is just an example, put here whatever you want.</span>
  <span class="pl-s1">controller</span><span class="pl-kos">.</span><span class="pl-en">view_context</span><span class="pl-kos">.</span><span class="pl-en">unsubscribed_path</span>
<span class="pl-k">end</span></pre></div>
<p>In case you need more customization, you can always overwrite <code>MailyHerald::TokensController</code> and its <code>get</code> method:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># app/controllers/maily_herald/tokens_controller.rb</span>
<span class="pl-k">module</span> <span class="pl-v">MailyHerald</span>
  <span class="pl-k">class</span> <span class="pl-v">TokensController</span> &lt; ::<span class="pl-v">ApplicationController</span>
    <span class="pl-en">before_action</span> <span class="pl-pds">:find_subscription</span>

    <span class="pl-k">def</span> <span class="pl-en">get</span>
      <span class="pl-k">if</span> <span class="pl-c1">@subscription</span> &amp;&amp; <span class="pl-c1">@subscription</span><span class="pl-kos">.</span><span class="pl-en">active?</span>
        <span class="pl-c1">@subscription</span><span class="pl-kos">.</span><span class="pl-en">deactivate!</span>
        <span class="pl-c"># now render some custom view</span>
      <span class="pl-k">else</span>
        <span class="pl-en">redirect_to</span><span class="pl-kos">(</span><span class="pl-en">main_app</span><span class="pl-kos">.</span><span class="pl-en">root_url</span><span class="pl-kos">)</span>
      <span class="pl-k">end</span>
    <span class="pl-k">end</span>

    <span class="pl-k">private</span>

    <span class="pl-k">def</span> <span class="pl-en">find_subscription</span>
      <span class="pl-c1">@subscription</span> ||= <span class="pl-v">MailyHerald</span>::<span class="pl-v">Subscription</span><span class="pl-kos">.</span><span class="pl-en">find_by_token</span><span class="pl-kos">(</span><span class="pl-en">params</span><span class="pl-kos">[</span><span class="pl-pds">:token</span><span class="pl-kos">]</span><span class="pl-kos">)</span>
    <span class="pl-k">end</span>
  <span class="pl-k">end</span>
<span class="pl-k">end</span></pre></div>
<h3><a id="user-content-redis-namespaces" class="anchor" aria-hidden="true" href="#redis-namespaces"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Redis namespaces</h3>
<p>If you want to use MailyHerald with non-standard Redis namespace, make sure your Sidekiq is also configured properly. This usually involves creating an initializer file:</p>
<div class="highlight highlight-source-ruby"><pre><span class="pl-c"># config/initializers/sidekiq.rb</span>
<span class="pl-v">Sidekiq</span><span class="pl-kos">.</span><span class="pl-en">configure_server</span> <span class="pl-k">do</span> |<span class="pl-s1">config</span>|
  <span class="pl-s1">config</span><span class="pl-kos">.</span><span class="pl-en">redis</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">namespace</span>: <span class="pl-s">'maily'</span> <span class="pl-kos">}</span>
<span class="pl-k">end</span>
<span class="pl-v">Sidekiq</span><span class="pl-kos">.</span><span class="pl-en">configure_client</span> <span class="pl-k">do</span> |<span class="pl-s1">config</span>|
  <span class="pl-s1">config</span><span class="pl-kos">.</span><span class="pl-en">redis</span> <span class="pl-c1">=</span> <span class="pl-kos">{</span> <span class="pl-pds">namespace</span>: <span class="pl-s">'maily'</span> <span class="pl-kos">}</span>
<span class="pl-k">end</span></pre></div>
<p>Then make sure you tell Maily about the change:</p>
<div class="highlight highlight-source-yaml"><pre><span class="pl-c"><span class="pl-c">#</span> config/maily_herald.yml</span>
---
<span class="pl-ent">:redis_namespace</span>: <span class="pl-s">maily</span></pre></div>
<h2><a id="user-content-contributing" class="anchor" aria-hidden="true" href="#contributing"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Contributing</h2>
<p>Please aim your pull requests to 'development' branch.</p>
<p>Your changes should be well tested. To set up test environment just run:</p>
<pre><code>RAILS_ENV=test rake db:setup
rspec
guard # execute specs interactively
</code></pre>
<h2><a id="user-content-more-information" class="anchor" aria-hidden="true" href="#more-information"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>More Information</h2>
<ul>
<li><a href="http://mailyherald.org" rel="nofollow">Home Page</a></li>
<li><a href="http://www.rubydoc.info/gems/maily_herald" rel="nofollow">API Docs</a></li>
<li><a href="http://showcase.sology.eu/maily_herald" rel="nofollow">Showcase</a></li>
<li><a href="https://github.com/Sology/maily_testapp">Sample application</a></li>
</ul>
<p>Although we work hard on MailyHerald development, we can't guarantee it is free of bugs. If you find one, please make sure to report it using <a href="https://github.com/Sology/maily_herald/issues">issues tracker on Github</a>. You can also post your feature requests there too.</p>
<h2><a id="user-content-license" class="anchor" aria-hidden="true" href="#license"><svg class="octicon octicon-link" viewBox="0 0 16 16" version="1.1" width="16" height="16" aria-hidden="true"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>License</h2>
<p>LGPLv3 License. Copyright 2013-2015 Sology. <a href="http://www.sology.eu" rel="nofollow">http://www.sology.eu</a></p>
<p>Initial development sponsored by Smart Language Apps Limited <a href="http://smartlanguageapps.com/" rel="nofollow">http://smartlanguageapps.com/</a></p>
</article></div>
</div></div></div></article><footer><div class="container"><div class="row"><div class="column">Total Projects: 1313</div><div class="column">Built On: 24 May 2020</div><div class="column">Version: 1.3.0</div></div></div></footer><script src="/selfhosted-awesome-unlist/site.js"></script></body></html>